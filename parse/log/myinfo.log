2019-03-18/07:16:31.437  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:31.954  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:34.428  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:34.441  INFO: parse.ParseDriver - Parsing command: SELECT language, account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, language, coalesce(sql, program, cmdline) as sql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id
WHERE query_hist_id is not NULL and sql is not null and length(sql)>50
group by language, account_id
order by cnt desc
2019-03-18/07:16:35.413  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:39.011  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.040  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.049  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.095  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.110  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.139  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.158  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.176  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.191  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.216  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.255  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.292  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.304  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.326  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.343  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.355  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.407  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:39.407  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, count(DISTINCT acc_id) as cnt from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id group by 1,2 order by 3
2019-03-18/07:16:39.410  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:42.496  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:42.496  INFO: parse.ParseDriver - Parsing command: insert overwrite table tenaliV2.usagemap partition (submit_time, source)
                        select  sub.query, sub.q_id, usagetable.tbl, usagetable.col, usagetable.usg, sub.account_id,
                        sub.submit_time, sub.source as source from (select n.query as query, n.query_hists_id as q_id,
                        n.q_ast as q_ast, n.account_id as account_id, n.submit_time as submit_time, n.source as source from tenaliV2.galaxy
                        as n where n.submit_time in ( '2019-02-20' ) and n.account_id IN (7845,4020) ) as sub lateral view
                        usageUDTFfromHiveTables(sub.query,sub.q_ast, sub.account_id) usagetable as tbl, col, usg
2019-03-18/07:16:42.502  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:43.830  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:43.830  INFO: parse.ParseDriver - Parsing command: WITH Sales_CTE 
AS  
-- Define the CTE query  
(  
    SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
    FROM Sales.SalesOrderHeader  
    WHERE SalesPersonID IS NOT NULL  
)  
-- Define the outer query referencing the CTE name.  
SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
FROM Sales_CTE  
GROUP BY SalesYear, SalesPersonID  
ORDER BY SalesPersonID, SalesYear
2019-03-18/07:16:43.834  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:45.143 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/sales/salesorderheader?account_id=5911
2019-03-18/07:16:45.156  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:45.156  INFO: parse.ParseDriver - Parsing command: CREATE TABLE myflightinfo2007 AS
    SELECT Year, Month, DepTime, ArrTime, FlightNum, Origin, Dest FROM FlightInfo2007
    WHERE (Month = 7 AND DayofMonth = 3) AND (Origin='JFK' AND Dest='ORD')
2019-03-18/07:16:45.158  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:46.468 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/flightinfo2007?account_id=5911
2019-03-18/07:16:46.473  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:46.473  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, s1.id from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id
2019-03-18/07:16:46.475  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:52.209  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:52.210  INFO: parse.ParseDriver - Parsing command: SELECT account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, coalesce(program, cmdline) as qsql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id 
WHERE query_hist_id is not NULL and qsql is not null and length(qsql)>50
group by account_id
order by 1 desc
2019-03-18/07:16:52.214  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:54.875  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:54.876  INFO: parse.ParseDriver - Parsing command: SELECT id, get_json(u.json, 'location') as info, to_date(created_at) as dt FROM db_users u JOIN (SELECT by_date.location, dt, num_users * 1000.0 / total_users as frac_of_location, num_users, total_users FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt limit 100
2019-03-18/07:16:54.886  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:56.402 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/07:16:57.119 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/07:16:57.835 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/07:16:57.845  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:57.845  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485623
2019-03-18/07:16:57.846  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:57.849  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485742
2019-03-18/07:16:57.849  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:57.852  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485862
2019-03-18/07:16:57.852  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:57.854  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_21404_1550506236
2019-03-18/07:16:57.854  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:57.856  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_22881_1550507276
2019-03-18/07:16:57.856  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:57.859  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_24201_1550508248
2019-03-18/07:16:57.859  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:57.862  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_25288_1550509187
2019-03-18/07:16:57.862  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:58.553  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:58.553  INFO: parse.ParseDriver - Parsing command: select name, myq from table1 lateral view explode(qual, gual) q as myq1, myq2
2019-03-18/07:16:58.554  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:16:59.883 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-18/07:16:59.887  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:16:59.888  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= '2019-01-01' and command_type = 'HiveCommand' and qlog like 'temp_temp' and   customer_name like '${customer=%}' group by  to_date(qh.created_at)
2019-03-18/07:16:59.889  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:01.214 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-18/07:17:01.931 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-18/07:17:02.649 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-18/07:17:02.654  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:02.654  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-18/07:17:02.657  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:05.097  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:05.097  INFO: parse.ParseDriver - Parsing command: alter table mm_viewability_events_test recover partitions
2019-03-18/07:17:05.104  INFO: parse.ParseDriver - Parsing command: select     report_timestamp,    to_date(report_timestamp) as impression_date,    campaign_name,     a.campaign_id,     strat.goal_type as strategy_goal_type, case when length(delphi_metadata)<1 then 'tree brain'   when delphi_metadata like '%_sb%' then 'shared brain'   when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,     case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag, is_viewable as viewable_impressions,  is_measurable as measurable_impressions,     1 as impressions, clicks as clicks,  total_spend_cpm/1000 as spend, -- sum(total_spend_cpm)/count(a.auction_id) as cpm, -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm, -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate, -- coalesce(sum(clicks)/count(a.auction_id),0) as ctr, -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,     video_start as video_start,     video_complete as video_complete,     pv_conversions,     pc_conversions,     pv_revenue,     pc_revenue,     device,     case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type-- coalesce(sum(video_complete)/sum(video_start),0) as vcr from  (select             report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-18/07:17:05.825  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:05.825  INFO: parse.ParseDriver - Parsing command: select      report_timestamp,     to_date(report_timestamp) as impression_date,     campaign_name,      a.campaign_id,      strat.goal_type as strategy_goal_type,  
case when length(delphi_metadata)<1 then 'tree brain'    
when delphi_metadata like '%_sb%' then 'shared brain'    
when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,      
case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag,  
is_viewable as viewable_impressions,   is_measurable as measurable_impressions,      1 as impressions,  clicks as clicks,   total_spend_cpm/1000 as spend,  
-- sum(total_spend_cpm)/count(a.auction_id) as cpm,  -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm,  -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate,  
-- coalesce(sum(clicks)/count(a.auction_id),0) as ctr,  -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,      video_start as video_start,      
video_complete as video_complete,      pv_conversions,      pc_conversions,      pv_revenue,      pc_revenue,      device,      
case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type 
-- coalesce(sum(video_complete)/sum(video_start),0) as vcr 
  from  (select   report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-18/07:17:06.438  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:06.438  INFO: parse.ParseDriver - Parsing command: select   at.pv_time_lag, at.pixel_id, e.v10, at.campaign_id, at.event_report_timestamp, at.device_type, at.campaign_name, at.event_timestamp_gmt, e.s9, e.s8, at.pixel_name, e.s2, e.s1, e.s7, e.s6, e.s5, e.s4, at.organization_name, at.strategy_name, at.event_date, e.s10, at.agency_id, at.organization_id, e.v1, at.agency_name, e.v3, e.v4, e.v5, e.v6, e.v7, e.v8, e.v9, at.impression_timestamp_gmt, at.advertiser_id, at.pc_time_lag, at.country, e.v2, e.s3, at.strategy_id, at.browser  from   (     select * from     mm_events    ) e   join    (     select * from     mm_attributed_events_ac   ) at   on       e.pixel_id = at.pixel_id       and e.mm_uuid = at.mm_uuid      and e.timestamp_gmt = at.event_timestamp_gmt  where   at.advertiser_id in (206401) and at.organization_id in (101607) and e.organization_id in (101607) and at.agency_id in (117415) and at.pixel_id in (1299912) and at.event_type = 'conversion' and at.event_date between '2019-03-04' and '2019-03-04' and e.event_date between '2019-03-04' and '2019-03-04'
2019-03-18/07:17:06.440  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:07.768 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_events?account_id=5911
2019-03-18/07:17:08.383 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_attributed_events_ac?account_id=5911
2019-03-18/07:17:08.389  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:08.389  INFO: parse.ParseDriver - Parsing command: select  customer,  cluster,  data,  dt,  ingestedtime  from   (select  customer,  cluster,  data,  dt,  ingestedtime,  row_number() over (partition by get_json_object(cluster,'$.clusterid') order by cast(regexp_replace(regexp_replace(ingestedtime, 'T',' '),'Z','') as timestamp) desc) rnum   from dsa_production.aiq_raw_optimized  where dt='2018-01-23'  and source='get_compute_inventory') a   where rnum=1
2019-03-18/07:17:08.393  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:09.719 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/dsa_production/aiq_raw_optimized?account_id=5911
2019-03-18/07:17:09.723  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:09.723  INFO: parse.ParseDriver - Parsing command: SELECT    logdate as the_date,    hour as the_hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold,    SUM(complete100) AS Complete100,    SUM(streams_viewed) AS Streams_viewed  FROM    
(       SELECT          logdate,          hour,          campaign_key,          placement_key,          ad_key,          IF(Isnull(streams_viewed), 0, streams_viewed) AS Streams_viewed,          IF(Isnull(complete100), 0, complete100) AS Complete100        FROM          core.stats_log        WHERE          logdate = '2019-03-10'           and hour = '11'     )    stats     
join       
(          SELECT             campaign_placement.campaign_placement_key AS campaign_placement_key,             campaign_placement.campaign_placement_id AS campaign_placement_id,             campaign_placement.campaign_placement_name AS campaign_placement_name,             opt_metric,             threshold           FROM             promo2.campaign_placement             
 join                
(                   SELECT                      campaign_placement_id,                      opt_metric,                      threshold                    FROM                      promo2.campaign_placement_optimization_filter                    WHERE                      upper(opt_metric) LIKE '%COMPLETIONS_KPI%'                       AND status = 'Active'                )                selected_placements                
 ON campaign_placement.campaign_placement_id = selected_placements.campaign_placement_id       )       selected_placements_decorated       
 ON selected_placements_decorated.campaign_placement_key = stats.placement_key     
join       promo2.ad a        ON stats.ad_key = a.ad_key     GROUP BY    logdate,    hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold
2019-03-18/07:17:09.725  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:11.455 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/core/stats_log?account_id=5911
2019-03-18/07:17:12.810 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement?account_id=5911
2019-03-18/07:17:13.903 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement_optimization_filter?account_id=5911
2019-03-18/07:17:14.732 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/ad?account_id=5911
2019-03-18/07:17:14.737  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:14.737  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-18/07:17:14.738  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:16.268 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-18/07:17:16.274  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:16.274  INFO: parse.ParseDriver - Parsing command: SELECT * FROM foo, LATERAL (SELECT * FROM bar WHERE bar.id = foo.bar_id) ss
2019-03-18/07:17:17.088  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:17.088  INFO: parse.ParseDriver - Parsing command: SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s group by a order by cnt
2019-03-18/07:17:17.089  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:18.478 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-18/07:17:18.482  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:18.496  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:18.496  INFO: parse.ParseDriver - Parsing command: SELECT s.a, b, e, count(s.b) as cnt from (select c as a, d as b from tab1 where c>0 and d<0)s join 
(select a, f from tab2)t on s.a=t.e 
group by s.a, b, e order by cnt
2019-03-18/07:17:18.498  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:20.599 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-18/07:17:21.491 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab2?account_id=5911
2019-03-18/07:17:21.494  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:21.501  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:21.501  INFO: parse.ParseDriver - Parsing command: WITH a AS (
  SELECT substr(name, 1, 3) x FROM tab1 )
SELECT *
FROM a
WHERE x = 'foo'
2019-03-18/07:17:21.501  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:22.848 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-18/07:17:23.310 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/a?account_id=5911
2019-03-18/07:17:23.312  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:23.317  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:23.317  INFO: parse.ParseDriver - Parsing command: SELECT IF(CARDINALITY(my_array) >= 3, my_array[3], NULL)
 FROM tab1
2019-03-18/07:17:23.317  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:24.563 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-18/07:17:24.565  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:24.570  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:24.570  INFO: parse.ParseDriver - Parsing command: select id, ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
2019-03-18/07:17:24.572  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:25.743 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-18/07:17:25.746  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:25.755  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:25.755  INFO: parse.ParseDriver - Parsing command: SELECT student, score
FROM tests CROSS JOIN UNNEST(scores) AS t (score)
2019-03-18/07:17:25.760  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:25.763  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:25.766  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:26.353  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:26.353  INFO: parse.ParseDriver - Parsing command: SELECT distinct tab.X1 AS a, X2 b from tab where a1>0 and a2!=0 and a3=9
2019-03-18/07:17:26.354  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:27.835 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-18/07:17:27.841  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:27.857  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:27.858  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:28.457  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:28.457  INFO: parse.ParseDriver - Parsing command: SELECT *

 FROM DEPT,

 LATERAL TABLE(RAMP(DEPT.DEPTNO)) adid
2019-03-18/07:17:28.465  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:29.076  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:29.078  INFO: parse.ParseDriver - Parsing command: SELECT  ci.id AS cluster_instance_id, ci.cluster_id, unix_timestamp(ci.start_at) AS start_at,  unix_timestamp(ci.down_at) AS down_at, _timestamp AS metric_time, _type AS metric_type,
CASE _type
   WHEN "MEMORY_STATS" THEN arr(total_available_memory, total_used_memory)
   WHEN "VCORES_STATS" THEN arr(total_available_vcores, total_used_vcores)
END AS total 
FROM (SELECT cluster_id, m.total_available_memory, m.total_used_memory, v.total_available_vcores, v.total_used_vcores, e._type, _int(e._timestamp/1000) AS _timestamp FROM processed.yarn 
,LATERAL Table( json_tuple(event_data, 'eventData', 'type', 'timestamp')) AS _eventData, _type, _timestamp 
,LATERAL Table( json_tuple(e._eventData, 'total_memory_mb', 'used_memory_mb'))  total_available_memory, total_used_memory
,LATERAL Table( json_tuple(e._eventData, 'total_vcores', 'used_vcores'))  total_available_vcores, total_used_vcores
WHERE event_date>="$start_date" AND  event_date<"$end_date" AND _type in ("MEMORY_STATS", "VCORES_STATS")) s 
JOIN rstore.cluster_insts ci ON s.cluster_id=ci.cluster_id
WHERE _timestamp BETWEEN unix_timestamp(ci.start_at) AND unix_timestamp(ci.down_at)
2019-03-18/07:17:29.117  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:29.842  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:29.843  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-18/07:17:29.845  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:31.020 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-18/07:17:31.026  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:31.034  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:31.034  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-18/07:17:31.619  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:31.619  INFO: parse.ParseDriver - Parsing command: select id,ts,1+sum(col) over(partition by id order by ts) as rnk
from (select id,ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
     ) t
2019-03-18/07:17:31.620  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:32.803 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-18/07:17:32.809  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:32.821  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:32.821  INFO: parse.ParseDriver - Parsing command: SELECT   JobTitle,
         MaritalStatus,
         AVG(VacationHours)
FROM     HumanResources.Employee AS E
GROUP BY JobTitle, MaritalStatus
HAVING   x in (select x from tab1)
2019-03-18/07:17:32.823  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:34.086 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/humanresources/employee?account_id=5911
2019-03-18/07:17:34.090  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:34.090  INFO: parse.ParseDriver - Parsing command: select venuestate, venueseats, venuename,
first_value(venuename)
over(partition by venuestate
order by venueseats desc
rows between unbounded preceding and unbounded following)
from (select * from venue where venueseats >0)
group by venuestate order by venuestate
2019-03-18/07:17:34.687  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:34.688  INFO: parse.ParseDriver - Parsing command: CREATE TABLE tabx AS SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s
2019-03-18/07:17:34.688  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:36.135 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-18/07:17:36.137  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:36.146  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:36.155  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:36.155  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-18/07:17:36.156  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:37.663 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-18/07:17:38.263 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-18/07:17:38.899 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-18/07:17:38.903  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:38.911  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/07:17:38.911  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt
2019-03-18/07:17:38.913  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:40.231 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/07:17:40.682 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/07:17:41.152 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/07:17:41.156  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM table1) v on u.a=v.b
2019-03-18/07:17:41.157  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:41.679 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/07:17:42.170 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-18/07:17:42.172  INFO: parse.ParseDriver - Parsing command: SELECT a,b, count(*) from ab where s='jrenv' GROUP BY a, b
2019-03-18/07:17:42.173  INFO: parse.ParseDriver - Parse Completed
2019-03-18/07:17:42.792 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/ab?account_id=5911
2019-03-18/07:17:42.799  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:32.495  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:33.119  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:34.468  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:34.482  INFO: parse.ParseDriver - Parsing command: SELECT language, account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, language, coalesce(sql, program, cmdline) as sql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id
WHERE query_hist_id is not NULL and sql is not null and length(sql)>50
group by language, account_id
order by cnt desc
2019-03-18/10:19:35.469  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:39.179  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.208  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.221  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.266  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.281  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.341  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.362  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.375  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.386  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.405  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.447  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.478  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.484  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.501  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.512  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.522  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.545  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:39.545  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, count(DISTINCT acc_id) as cnt from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id group by 1,2 order by 3
2019-03-18/10:19:39.549  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:42.143  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:42.144  INFO: parse.ParseDriver - Parsing command: insert overwrite table tenaliV2.usagemap partition (submit_time, source)
                        select  sub.query, sub.q_id, usagetable.tbl, usagetable.col, usagetable.usg, sub.account_id,
                        sub.submit_time, sub.source as source from (select n.query as query, n.query_hists_id as q_id,
                        n.q_ast as q_ast, n.account_id as account_id, n.submit_time as submit_time, n.source as source from tenaliV2.galaxy
                        as n where n.submit_time in ( '2019-02-20' ) and n.account_id IN (7845,4020) ) as sub lateral view
                        usageUDTFfromHiveTables(sub.query,sub.q_ast, sub.account_id) usagetable as tbl, col, usg
2019-03-18/10:19:42.150  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:43.287  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:43.287  INFO: parse.ParseDriver - Parsing command: WITH Sales_CTE 
AS  
-- Define the CTE query  
(  
    SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
    FROM Sales.SalesOrderHeader  
    WHERE SalesPersonID IS NOT NULL  
)  
-- Define the outer query referencing the CTE name.  
SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
FROM Sales_CTE  
GROUP BY SalesYear, SalesPersonID  
ORDER BY SalesPersonID, SalesYear
2019-03-18/10:19:43.291  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:44.907 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/sales/salesorderheader?account_id=5911
2019-03-18/10:19:44.920  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:44.921  INFO: parse.ParseDriver - Parsing command: CREATE TABLE myflightinfo2007 AS
    SELECT Year, Month, DepTime, ArrTime, FlightNum, Origin, Dest FROM FlightInfo2007
    WHERE (Month = 7 AND DayofMonth = 3) AND (Origin='JFK' AND Dest='ORD')
2019-03-18/10:19:44.923  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:46.023 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/flightinfo2007?account_id=5911
2019-03-18/10:19:46.029  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:46.029  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, s1.id from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id
2019-03-18/10:19:46.031  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:47.841  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:47.842  INFO: parse.ParseDriver - Parsing command: SELECT account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, coalesce(program, cmdline) as qsql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id 
WHERE query_hist_id is not NULL and qsql is not null and length(qsql)>50
group by account_id
order by 1 desc
2019-03-18/10:19:47.845  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:51.359  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:51.359  INFO: parse.ParseDriver - Parsing command: SELECT id, get_json(u.json, 'location') as info, to_date(created_at) as dt FROM db_users u JOIN (SELECT by_date.location, dt, num_users * 1000.0 / total_users as frac_of_location, num_users, total_users FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt limit 100
2019-03-18/10:19:51.372  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:52.523 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/10:19:53.075 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/10:19:53.595 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/10:19:53.604  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:53.604  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485623
2019-03-18/10:19:53.605  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:53.607  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485742
2019-03-18/10:19:53.608  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:53.610  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485862
2019-03-18/10:19:53.610  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:53.612  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_21404_1550506236
2019-03-18/10:19:53.612  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:53.613  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_22881_1550507276
2019-03-18/10:19:53.614  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:53.615  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_24201_1550508248
2019-03-18/10:19:53.615  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:53.618  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_25288_1550509187
2019-03-18/10:19:53.618  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:54.136  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:54.136  INFO: parse.ParseDriver - Parsing command: select name, myq from table1 lateral view explode(qual, gual) q as myq1, myq2
2019-03-18/10:19:54.137  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:55.495 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-18/10:19:55.504  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:55.504  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= '2019-01-01' and command_type = 'HiveCommand' and qlog like 'temp_temp' and   customer_name like '${customer=%}' group by  to_date(qh.created_at)
2019-03-18/10:19:55.507  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:56.413 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-18/10:19:56.812 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-18/10:19:57.400 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-18/10:19:57.406  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:57.406  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-18/10:19:57.411  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:19:59.245  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:59.245  INFO: parse.ParseDriver - Parsing command: alter table mm_viewability_events_test recover partitions
2019-03-18/10:19:59.253  INFO: parse.ParseDriver - Parsing command: select     report_timestamp,    to_date(report_timestamp) as impression_date,    campaign_name,     a.campaign_id,     strat.goal_type as strategy_goal_type, case when length(delphi_metadata)<1 then 'tree brain'   when delphi_metadata like '%_sb%' then 'shared brain'   when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,     case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag, is_viewable as viewable_impressions,  is_measurable as measurable_impressions,     1 as impressions, clicks as clicks,  total_spend_cpm/1000 as spend, -- sum(total_spend_cpm)/count(a.auction_id) as cpm, -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm, -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate, -- coalesce(sum(clicks)/count(a.auction_id),0) as ctr, -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,     video_start as video_start,     video_complete as video_complete,     pv_conversions,     pc_conversions,     pv_revenue,     pc_revenue,     device,     case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type-- coalesce(sum(video_complete)/sum(video_start),0) as vcr from  (select             report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-18/10:19:59.851  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:19:59.851  INFO: parse.ParseDriver - Parsing command: select      report_timestamp,     to_date(report_timestamp) as impression_date,     campaign_name,      a.campaign_id,      strat.goal_type as strategy_goal_type,  
case when length(delphi_metadata)<1 then 'tree brain'    
when delphi_metadata like '%_sb%' then 'shared brain'    
when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,      
case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag,  
is_viewable as viewable_impressions,   is_measurable as measurable_impressions,      1 as impressions,  clicks as clicks,   total_spend_cpm/1000 as spend,  
-- sum(total_spend_cpm)/count(a.auction_id) as cpm,  -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm,  -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate,  
-- coalesce(sum(clicks)/count(a.auction_id),0) as ctr,  -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,      video_start as video_start,      
video_complete as video_complete,      pv_conversions,      pc_conversions,      pv_revenue,      pc_revenue,      device,      
case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type 
-- coalesce(sum(video_complete)/sum(video_start),0) as vcr 
  from  (select   report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-18/10:20:00.295  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:00.295  INFO: parse.ParseDriver - Parsing command: select   at.pv_time_lag, at.pixel_id, e.v10, at.campaign_id, at.event_report_timestamp, at.device_type, at.campaign_name, at.event_timestamp_gmt, e.s9, e.s8, at.pixel_name, e.s2, e.s1, e.s7, e.s6, e.s5, e.s4, at.organization_name, at.strategy_name, at.event_date, e.s10, at.agency_id, at.organization_id, e.v1, at.agency_name, e.v3, e.v4, e.v5, e.v6, e.v7, e.v8, e.v9, at.impression_timestamp_gmt, at.advertiser_id, at.pc_time_lag, at.country, e.v2, e.s3, at.strategy_id, at.browser  from   (     select * from     mm_events    ) e   join    (     select * from     mm_attributed_events_ac   ) at   on       e.pixel_id = at.pixel_id       and e.mm_uuid = at.mm_uuid      and e.timestamp_gmt = at.event_timestamp_gmt  where   at.advertiser_id in (206401) and at.organization_id in (101607) and e.organization_id in (101607) and at.agency_id in (117415) and at.pixel_id in (1299912) and at.event_type = 'conversion' and at.event_date between '2019-03-04' and '2019-03-04' and e.event_date between '2019-03-04' and '2019-03-04'
2019-03-18/10:20:00.297  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:01.314 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_events?account_id=5911
2019-03-18/10:20:01.799 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_attributed_events_ac?account_id=5911
2019-03-18/10:20:01.807  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:01.807  INFO: parse.ParseDriver - Parsing command: select  customer,  cluster,  data,  dt,  ingestedtime  from   (select  customer,  cluster,  data,  dt,  ingestedtime,  row_number() over (partition by get_json_object(cluster,'$.clusterid') order by cast(regexp_replace(regexp_replace(ingestedtime, 'T',' '),'Z','') as timestamp) desc) rnum   from dsa_production.aiq_raw_optimized  where dt='2018-01-23'  and source='get_compute_inventory') a   where rnum=1
2019-03-18/10:20:01.812  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:03.117 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/dsa_production/aiq_raw_optimized?account_id=5911
2019-03-18/10:20:03.122  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:03.122  INFO: parse.ParseDriver - Parsing command: SELECT    logdate as the_date,    hour as the_hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold,    SUM(complete100) AS Complete100,    SUM(streams_viewed) AS Streams_viewed  FROM    
(       SELECT          logdate,          hour,          campaign_key,          placement_key,          ad_key,          IF(Isnull(streams_viewed), 0, streams_viewed) AS Streams_viewed,          IF(Isnull(complete100), 0, complete100) AS Complete100        FROM          core.stats_log        WHERE          logdate = '2019-03-10'           and hour = '11'     )    stats     
join       
(          SELECT             campaign_placement.campaign_placement_key AS campaign_placement_key,             campaign_placement.campaign_placement_id AS campaign_placement_id,             campaign_placement.campaign_placement_name AS campaign_placement_name,             opt_metric,             threshold           FROM             promo2.campaign_placement             
 join                
(                   SELECT                      campaign_placement_id,                      opt_metric,                      threshold                    FROM                      promo2.campaign_placement_optimization_filter                    WHERE                      upper(opt_metric) LIKE '%COMPLETIONS_KPI%'                       AND status = 'Active'                )                selected_placements                
 ON campaign_placement.campaign_placement_id = selected_placements.campaign_placement_id       )       selected_placements_decorated       
 ON selected_placements_decorated.campaign_placement_key = stats.placement_key     
join       promo2.ad a        ON stats.ad_key = a.ad_key     GROUP BY    logdate,    hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold
2019-03-18/10:20:03.124  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:04.155 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/core/stats_log?account_id=5911
2019-03-18/10:20:04.764 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement?account_id=5911
2019-03-18/10:20:05.480 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement_optimization_filter?account_id=5911
2019-03-18/10:20:06.112 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/ad?account_id=5911
2019-03-18/10:20:06.119  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:06.119  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-18/10:20:06.121  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:07.736 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-18/10:20:07.743  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:07.743  INFO: parse.ParseDriver - Parsing command: SELECT * FROM foo, LATERAL (SELECT * FROM bar WHERE bar.id = foo.bar_id) ss
2019-03-18/10:20:08.312  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:08.313  INFO: parse.ParseDriver - Parsing command: SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s group by a order by cnt
2019-03-18/10:20:08.314  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:09.313 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-18/10:20:09.316  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:09.323  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:09.323  INFO: parse.ParseDriver - Parsing command: SELECT s.a, b, e, count(s.b) as cnt from (select c as a, d as b from tab1 where c>0 and d<0)s join 
(select a, f from tab2)t on s.a=t.e 
group by s.a, b, e order by cnt
2019-03-18/10:20:09.324  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:10.398 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-18/10:20:10.810 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab2?account_id=5911
2019-03-18/10:20:10.813  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:10.823  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:10.823  INFO: parse.ParseDriver - Parsing command: WITH a AS (
  SELECT substr(name, 1, 3) x FROM tab1 )
SELECT *
FROM a
WHERE x = 'foo'
2019-03-18/10:20:10.824  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:11.865 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-18/10:20:12.333 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/a?account_id=5911
2019-03-18/10:20:12.336  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:12.341  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:12.341  INFO: parse.ParseDriver - Parsing command: SELECT IF(CARDINALITY(my_array) >= 3, my_array[3], NULL)
 FROM tab1
2019-03-18/10:20:12.342  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:14.237 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-18/10:20:14.240  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:14.246  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:14.246  INFO: parse.ParseDriver - Parsing command: select id, ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
2019-03-18/10:20:14.247  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:16.048 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-18/10:20:16.051  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:16.061  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:16.061  INFO: parse.ParseDriver - Parsing command: SELECT student, score
FROM tests CROSS JOIN UNNEST(scores) AS t (score)
2019-03-18/10:20:16.063  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:16.066  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:16.069  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:16.643  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:16.643  INFO: parse.ParseDriver - Parsing command: SELECT distinct tab.X1 AS a, X2 b from tab where a1>0 and a2!=0 and a3=9
2019-03-18/10:20:16.643  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:17.975 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-18/10:20:17.977  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:17.987  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:17.988  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:18.511  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:18.511  INFO: parse.ParseDriver - Parsing command: SELECT *

 FROM DEPT,

 LATERAL TABLE(RAMP(DEPT.DEPTNO)) adid
2019-03-18/10:20:18.517  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:19.101  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:19.101  INFO: parse.ParseDriver - Parsing command: SELECT  ci.id AS cluster_instance_id, ci.cluster_id, unix_timestamp(ci.start_at) AS start_at,  unix_timestamp(ci.down_at) AS down_at, _timestamp AS metric_time, _type AS metric_type,
CASE _type
   WHEN "MEMORY_STATS" THEN arr(total_available_memory, total_used_memory)
   WHEN "VCORES_STATS" THEN arr(total_available_vcores, total_used_vcores)
END AS total 
FROM (SELECT cluster_id, m.total_available_memory, m.total_used_memory, v.total_available_vcores, v.total_used_vcores, e._type, _int(e._timestamp/1000) AS _timestamp FROM processed.yarn 
,LATERAL Table( json_tuple(event_data, 'eventData', 'type', 'timestamp')) AS _eventData, _type, _timestamp 
,LATERAL Table( json_tuple(e._eventData, 'total_memory_mb', 'used_memory_mb'))  total_available_memory, total_used_memory
,LATERAL Table( json_tuple(e._eventData, 'total_vcores', 'used_vcores'))  total_available_vcores, total_used_vcores
WHERE event_date>="$start_date" AND  event_date<"$end_date" AND _type in ("MEMORY_STATS", "VCORES_STATS")) s 
JOIN rstore.cluster_insts ci ON s.cluster_id=ci.cluster_id
WHERE _timestamp BETWEEN unix_timestamp(ci.start_at) AND unix_timestamp(ci.down_at)
2019-03-18/10:20:19.120  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:19.689  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:19.690  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-18/10:20:19.691  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:20.945 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-18/10:20:20.948  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:20.955  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:20.955  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-18/10:20:21.461  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:21.461  INFO: parse.ParseDriver - Parsing command: select id,ts,1+sum(col) over(partition by id order by ts) as rnk
from (select id,ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
     ) t
2019-03-18/10:20:21.462  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:22.786 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-18/10:20:22.790  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:22.801  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:22.801  INFO: parse.ParseDriver - Parsing command: SELECT   JobTitle,
         MaritalStatus,
         AVG(VacationHours)
FROM     HumanResources.Employee AS E
GROUP BY JobTitle, MaritalStatus
HAVING   x in (select x from tab1)
2019-03-18/10:20:22.803  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:23.756 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/humanresources/employee?account_id=5911
2019-03-18/10:20:23.759  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:23.760  INFO: parse.ParseDriver - Parsing command: select venuestate, venueseats, venuename,
first_value(venuename)
over(partition by venuestate
order by venueseats desc
rows between unbounded preceding and unbounded following)
from (select * from venue where venueseats >0)
group by venuestate order by venuestate
2019-03-18/10:20:24.222  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:24.222  INFO: parse.ParseDriver - Parsing command: CREATE TABLE tabx AS SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s
2019-03-18/10:20:24.222  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:28.420 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-18/10:20:28.424  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:28.429  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:28.437  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:28.437  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-18/10:20:28.438  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:29.437 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-18/10:20:29.987 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-18/10:20:30.408 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-18/10:20:30.413  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:30.422  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/10:20:30.422  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt
2019-03-18/10:20:30.426  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:31.696 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/10:20:32.617 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/10:20:33.202 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/10:20:33.205  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM table1) v on u.a=v.b
2019-03-18/10:20:33.206  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:34.058 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-18/10:20:35.075 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-18/10:20:35.078  INFO: parse.ParseDriver - Parsing command: SELECT a,b, count(*) from ab where s='jrenv' GROUP BY a, b
2019-03-18/10:20:35.079  INFO: parse.ParseDriver - Parse Completed
2019-03-18/10:20:35.999 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/ab?account_id=5911
2019-03-18/10:20:36.003  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/15:33:00.890  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-18/15:33:00.905  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-18/15:33:01.928  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:35:55.194  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:35:55.729  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:35:57.468  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:35:57.483  INFO: parse.ParseDriver - Parsing command: SELECT language, account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, language, coalesce(sql, program, cmdline) as sql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id
WHERE query_hist_id is not NULL and sql is not null and length(sql)>50
group by language, account_id
order by cnt desc
2019-03-19/09:35:58.517  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:02.640  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.668  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.676  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.727  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.746  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.782  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.801  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.818  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.833  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.852  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.896  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.927  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.938  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.958  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.970  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:02.978  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:03.011  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:03.012  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, count(DISTINCT acc_id) as cnt from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id group by 1,2 order by 3
2019-03-19/09:36:03.014  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:06.595  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:06.595  INFO: parse.ParseDriver - Parsing command: insert overwrite table tenaliV2.usagemap partition (submit_time, source)
                        select  sub.query, sub.q_id, usagetable.tbl, usagetable.col, usagetable.usg, sub.account_id,
                        sub.submit_time, sub.source as source from (select n.query as query, n.query_hists_id as q_id,
                        n.q_ast as q_ast, n.account_id as account_id, n.submit_time as submit_time, n.source as source from tenaliV2.galaxy
                        as n where n.submit_time in ( '2019-02-20' ) and n.account_id IN (7845,4020) ) as sub lateral view
                        usageUDTFfromHiveTables(sub.query,sub.q_ast, sub.account_id) usagetable as tbl, col, usg
2019-03-19/09:36:06.602  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:08.444  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:08.444  INFO: parse.ParseDriver - Parsing command: WITH Sales_CTE 
AS  
-- Define the CTE query  
(  
    SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
    FROM Sales.SalesOrderHeader  
    WHERE SalesPersonID IS NOT NULL  
)  
-- Define the outer query referencing the CTE name.  
SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
FROM Sales_CTE  
GROUP BY SalesYear, SalesPersonID  
ORDER BY SalesPersonID, SalesYear
2019-03-19/09:36:08.447  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:13.855 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/sales/salesorderheader?account_id=5911
2019-03-19/09:36:13.869  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:13.870  INFO: parse.ParseDriver - Parsing command: CREATE TABLE myflightinfo2007 AS
    SELECT Year, Month, DepTime, ArrTime, FlightNum, Origin, Dest FROM FlightInfo2007
    WHERE (Month = 7 AND DayofMonth = 3) AND (Origin='JFK' AND Dest='ORD')
2019-03-19/09:36:13.872  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:15.288 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/flightinfo2007?account_id=5911
2019-03-19/09:36:15.292  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:15.293  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, s1.id from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id
2019-03-19/09:36:15.294  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:18.777  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:18.777  INFO: parse.ParseDriver - Parsing command: SELECT account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, coalesce(program, cmdline) as qsql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id 
WHERE query_hist_id is not NULL and qsql is not null and length(qsql)>50
group by account_id
order by 1 desc
2019-03-19/09:36:18.781  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:22.342  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:22.343  INFO: parse.ParseDriver - Parsing command: SELECT id, get_json(u.json, 'location') as info, to_date(created_at) as dt FROM db_users u JOIN (SELECT by_date.location, dt, num_users * 1000.0 / total_users as frac_of_location, num_users, total_users FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt limit 100
2019-03-19/09:36:22.353  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:23.692 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:36:24.299 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:36:24.751 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:36:24.760  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:24.760  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485623
2019-03-19/09:36:24.761  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:24.763  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485742
2019-03-19/09:36:24.764  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:24.765  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485862
2019-03-19/09:36:24.766  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:24.768  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_21404_1550506236
2019-03-19/09:36:24.768  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:24.770  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_22881_1550507276
2019-03-19/09:36:24.770  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:24.772  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_24201_1550508248
2019-03-19/09:36:24.772  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:24.774  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_25288_1550509187
2019-03-19/09:36:24.774  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:25.370  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:25.371  INFO: parse.ParseDriver - Parsing command: select name, myq from table1 lateral view explode(qual, gual) q as myq1, myq2
2019-03-19/09:36:25.371  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:26.731 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-19/09:36:26.736  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:26.736  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= '2019-01-01' and command_type = 'HiveCommand' and qlog like 'temp_temp' and   customer_name like '${customer=%}' group by  to_date(qh.created_at)
2019-03-19/09:36:26.738  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:29.216 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-19/09:36:30.137 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-19/09:36:30.915 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-19/09:36:30.922  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:30.922  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-19/09:36:30.925  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:33.841  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:33.841  INFO: parse.ParseDriver - Parsing command: alter table mm_viewability_events_test recover partitions
2019-03-19/09:36:33.849  INFO: parse.ParseDriver - Parsing command: select     report_timestamp,    to_date(report_timestamp) as impression_date,    campaign_name,     a.campaign_id,     strat.goal_type as strategy_goal_type, case when length(delphi_metadata)<1 then 'tree brain'   when delphi_metadata like '%_sb%' then 'shared brain'   when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,     case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag, is_viewable as viewable_impressions,  is_measurable as measurable_impressions,     1 as impressions, clicks as clicks,  total_spend_cpm/1000 as spend, -- sum(total_spend_cpm)/count(a.auction_id) as cpm, -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm, -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate, -- coalesce(sum(clicks)/count(a.auction_id),0) as ctr, -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,     video_start as video_start,     video_complete as video_complete,     pv_conversions,     pc_conversions,     pv_revenue,     pc_revenue,     device,     case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type-- coalesce(sum(video_complete)/sum(video_start),0) as vcr from  (select             report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-19/09:36:34.748  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:34.748  INFO: parse.ParseDriver - Parsing command: select      report_timestamp,     to_date(report_timestamp) as impression_date,     campaign_name,      a.campaign_id,      strat.goal_type as strategy_goal_type,  
case when length(delphi_metadata)<1 then 'tree brain'    
when delphi_metadata like '%_sb%' then 'shared brain'    
when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,      
case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag,  
is_viewable as viewable_impressions,   is_measurable as measurable_impressions,      1 as impressions,  clicks as clicks,   total_spend_cpm/1000 as spend,  
-- sum(total_spend_cpm)/count(a.auction_id) as cpm,  -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm,  -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate,  
-- coalesce(sum(clicks)/count(a.auction_id),0) as ctr,  -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,      video_start as video_start,      
video_complete as video_complete,      pv_conversions,      pc_conversions,      pv_revenue,      pc_revenue,      device,      
case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type 
-- coalesce(sum(video_complete)/sum(video_start),0) as vcr 
  from  (select   report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-19/09:36:35.303  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:35.303  INFO: parse.ParseDriver - Parsing command: select   at.pv_time_lag, at.pixel_id, e.v10, at.campaign_id, at.event_report_timestamp, at.device_type, at.campaign_name, at.event_timestamp_gmt, e.s9, e.s8, at.pixel_name, e.s2, e.s1, e.s7, e.s6, e.s5, e.s4, at.organization_name, at.strategy_name, at.event_date, e.s10, at.agency_id, at.organization_id, e.v1, at.agency_name, e.v3, e.v4, e.v5, e.v6, e.v7, e.v8, e.v9, at.impression_timestamp_gmt, at.advertiser_id, at.pc_time_lag, at.country, e.v2, e.s3, at.strategy_id, at.browser  from   (     select * from     mm_events    ) e   join    (     select * from     mm_attributed_events_ac   ) at   on       e.pixel_id = at.pixel_id       and e.mm_uuid = at.mm_uuid      and e.timestamp_gmt = at.event_timestamp_gmt  where   at.advertiser_id in (206401) and at.organization_id in (101607) and e.organization_id in (101607) and at.agency_id in (117415) and at.pixel_id in (1299912) and at.event_type = 'conversion' and at.event_date between '2019-03-04' and '2019-03-04' and e.event_date between '2019-03-04' and '2019-03-04'
2019-03-19/09:36:35.305  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:37.562 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_events?account_id=5911
2019-03-19/09:36:39.049 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_attributed_events_ac?account_id=5911
2019-03-19/09:36:39.057  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:39.057  INFO: parse.ParseDriver - Parsing command: select  customer,  cluster,  data,  dt,  ingestedtime  from   (select  customer,  cluster,  data,  dt,  ingestedtime,  row_number() over (partition by get_json_object(cluster,'$.clusterid') order by cast(regexp_replace(regexp_replace(ingestedtime, 'T',' '),'Z','') as timestamp) desc) rnum   from dsa_production.aiq_raw_optimized  where dt='2018-01-23'  and source='get_compute_inventory') a   where rnum=1
2019-03-19/09:36:39.061  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:40.903 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/dsa_production/aiq_raw_optimized?account_id=5911
2019-03-19/09:36:40.908  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:40.908  INFO: parse.ParseDriver - Parsing command: SELECT    logdate as the_date,    hour as the_hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold,    SUM(complete100) AS Complete100,    SUM(streams_viewed) AS Streams_viewed  FROM    
(       SELECT          logdate,          hour,          campaign_key,          placement_key,          ad_key,          IF(Isnull(streams_viewed), 0, streams_viewed) AS Streams_viewed,          IF(Isnull(complete100), 0, complete100) AS Complete100        FROM          core.stats_log        WHERE          logdate = '2019-03-10'           and hour = '11'     )    stats     
join       
(          SELECT             campaign_placement.campaign_placement_key AS campaign_placement_key,             campaign_placement.campaign_placement_id AS campaign_placement_id,             campaign_placement.campaign_placement_name AS campaign_placement_name,             opt_metric,             threshold           FROM             promo2.campaign_placement             
 join                
(                   SELECT                      campaign_placement_id,                      opt_metric,                      threshold                    FROM                      promo2.campaign_placement_optimization_filter                    WHERE                      upper(opt_metric) LIKE '%COMPLETIONS_KPI%'                       AND status = 'Active'                )                selected_placements                
 ON campaign_placement.campaign_placement_id = selected_placements.campaign_placement_id       )       selected_placements_decorated       
 ON selected_placements_decorated.campaign_placement_key = stats.placement_key     
join       promo2.ad a        ON stats.ad_key = a.ad_key     GROUP BY    logdate,    hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold
2019-03-19/09:36:40.910  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:42.443 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/core/stats_log?account_id=5911
2019-03-19/09:36:43.049 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement?account_id=5911
2019-03-19/09:36:43.523 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement_optimization_filter?account_id=5911
2019-03-19/09:36:44.003 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/ad?account_id=5911
2019-03-19/09:36:44.008  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:44.008  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-19/09:36:44.009  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:45.745 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-19/09:36:45.752  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:45.752  INFO: parse.ParseDriver - Parsing command: SELECT * FROM foo, LATERAL (SELECT * FROM bar WHERE bar.id = foo.bar_id) ss
2019-03-19/09:36:47.036  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:47.036  INFO: parse.ParseDriver - Parsing command: SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s group by a order by cnt
2019-03-19/09:36:47.039  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:48.570 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-19/09:36:48.575  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:48.580  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:48.580  INFO: parse.ParseDriver - Parsing command: SELECT s.a, b, e, count(s.b) as cnt from (select c as a, d as b from tab1 where c>0 and d<0)s join 
(select a, f from tab2)t on s.a=t.e 
group by s.a, b, e order by cnt
2019-03-19/09:36:48.581  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:50.881 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-19/09:36:51.492 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab2?account_id=5911
2019-03-19/09:36:51.497  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:51.505  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:51.505  INFO: parse.ParseDriver - Parsing command: WITH a AS (
  SELECT substr(name, 1, 3) x FROM tab1 )
SELECT *
FROM a
WHERE x = 'foo'
2019-03-19/09:36:51.506  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:53.484 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-19/09:36:54.449 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/a?account_id=5911
2019-03-19/09:36:54.451  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:54.456  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:54.456  INFO: parse.ParseDriver - Parsing command: SELECT IF(CARDINALITY(my_array) >= 3, my_array[3], NULL)
 FROM tab1
2019-03-19/09:36:54.456  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:56.152 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-19/09:36:56.155  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:56.160  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:56.160  INFO: parse.ParseDriver - Parsing command: select id, ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
2019-03-19/09:36:56.161  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:36:58.097 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-19/09:36:58.100  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:58.110  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:58.110  INFO: parse.ParseDriver - Parsing command: SELECT student, score
FROM tests CROSS JOIN UNNEST(scores) AS t (score)
2019-03-19/09:36:58.112  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:58.115  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:58.117  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:59.015  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:36:59.015  INFO: parse.ParseDriver - Parsing command: SELECT distinct tab.X1 AS a, X2 b from tab where a1>0 and a2!=0 and a3=9
2019-03-19/09:36:59.016  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:37:01.166 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-19/09:37:01.169  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:01.182  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:01.183  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:02.087  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:02.087  INFO: parse.ParseDriver - Parsing command: SELECT *

 FROM DEPT,

 LATERAL TABLE(RAMP(DEPT.DEPTNO)) adid
2019-03-19/09:37:02.093  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:02.757  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:02.757  INFO: parse.ParseDriver - Parsing command: SELECT  ci.id AS cluster_instance_id, ci.cluster_id, unix_timestamp(ci.start_at) AS start_at,  unix_timestamp(ci.down_at) AS down_at, _timestamp AS metric_time, _type AS metric_type,
CASE _type
   WHEN "MEMORY_STATS" THEN arr(total_available_memory, total_used_memory)
   WHEN "VCORES_STATS" THEN arr(total_available_vcores, total_used_vcores)
END AS total 
FROM (SELECT cluster_id, m.total_available_memory, m.total_used_memory, v.total_available_vcores, v.total_used_vcores, e._type, _int(e._timestamp/1000) AS _timestamp FROM processed.yarn 
,LATERAL Table( json_tuple(event_data, 'eventData', 'type', 'timestamp')) AS _eventData, _type, _timestamp 
,LATERAL Table( json_tuple(e._eventData, 'total_memory_mb', 'used_memory_mb'))  total_available_memory, total_used_memory
,LATERAL Table( json_tuple(e._eventData, 'total_vcores', 'used_vcores'))  total_available_vcores, total_used_vcores
WHERE event_date>="$start_date" AND  event_date<"$end_date" AND _type in ("MEMORY_STATS", "VCORES_STATS")) s 
JOIN rstore.cluster_insts ci ON s.cluster_id=ci.cluster_id
WHERE _timestamp BETWEEN unix_timestamp(ci.start_at) AND unix_timestamp(ci.down_at)
2019-03-19/09:37:02.763  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:03.410  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:03.410  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-19/09:37:03.411  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:37:05.467 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-19/09:37:05.470  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:05.475  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:05.476  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-19/09:37:07.063  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:07.064  INFO: parse.ParseDriver - Parsing command: select id,ts,1+sum(col) over(partition by id order by ts) as rnk
from (select id,ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
     ) t
2019-03-19/09:37:07.064  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:37:09.526 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-19/09:37:09.529  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:09.535  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:37:09.535  INFO: parse.ParseDriver - Parsing command: SELECT   JobTitle,
         MaritalStatus,
         AVG(VacationHours)
FROM     HumanResources.Employee AS E
GROUP BY JobTitle, MaritalStatus
HAVING   x in (select x from tab1)
2019-03-19/09:37:09.536  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:06.288  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:06.957  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:08.765  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:08.779  INFO: parse.ParseDriver - Parsing command: SELECT language, account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, language, coalesce(sql, program, cmdline) as sql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id
WHERE query_hist_id is not NULL and sql is not null and length(sql)>50
group by language, account_id
order by cnt desc
2019-03-19/09:58:09.811  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:12.435  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.517  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.569  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.649  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.736  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.819  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.875  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.937  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:12.949  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.001  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.118  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.228  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.237  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.302  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.319  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.335  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.457  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:13.458  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, count(DISTINCT acc_id) as cnt from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id group by 1,2 order by 3
2019-03-19/09:58:13.464  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:15.265  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:15.265  INFO: parse.ParseDriver - Parsing command: insert overwrite table tenaliV2.usagemap partition (submit_time, source)
                        select  sub.query, sub.q_id, usagetable.tbl, usagetable.col, usagetable.usg, sub.account_id,
                        sub.submit_time, sub.source as source from (select n.query as query, n.query_hists_id as q_id,
                        n.q_ast as q_ast, n.account_id as account_id, n.submit_time as submit_time, n.source as source from tenaliV2.galaxy
                        as n where n.submit_time in ( '2019-02-20' ) and n.account_id IN (7845,4020) ) as sub lateral view
                        usageUDTFfromHiveTables(sub.query,sub.q_ast, sub.account_id) usagetable as tbl, col, usg
2019-03-19/09:58:15.272  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:16.236  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:16.236  INFO: parse.ParseDriver - Parsing command: WITH Sales_CTE 
AS  
-- Define the CTE query  
(  
    SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
    FROM Sales.SalesOrderHeader  
    WHERE SalesPersonID IS NOT NULL  
)  
-- Define the outer query referencing the CTE name.  
SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
FROM Sales_CTE  
GROUP BY SalesYear, SalesPersonID  
ORDER BY SalesPersonID, SalesYear
2019-03-19/09:58:16.245  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:17.149 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/sales/salesorderheader?account_id=5911
2019-03-19/09:58:17.161  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:17.161  INFO: parse.ParseDriver - Parsing command: CREATE TABLE myflightinfo2007 AS
    SELECT Year, Month, DepTime, ArrTime, FlightNum, Origin, Dest FROM FlightInfo2007
    WHERE (Month = 7 AND DayofMonth = 3) AND (Origin='JFK' AND Dest='ORD')
2019-03-19/09:58:17.164  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:18.101 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/flightinfo2007?account_id=5911
2019-03-19/09:58:18.109  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:18.110  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, s1.id from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id
2019-03-19/09:58:18.113  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:19.896  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:19.897  INFO: parse.ParseDriver - Parsing command: SELECT account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, coalesce(program, cmdline) as qsql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id 
WHERE query_hist_id is not NULL and qsql is not null and length(qsql)>50
group by account_id
order by 1 desc
2019-03-19/09:58:19.903  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:22.136  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:22.136  INFO: parse.ParseDriver - Parsing command: SELECT id, get_json(u.json, 'location') as info, to_date(created_at) as dt FROM db_users u JOIN (SELECT by_date.location, dt, num_users * 1000.0 / total_users as frac_of_location, num_users, total_users FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt limit 100
2019-03-19/09:58:22.153  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:23.097 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:58:23.508 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:58:23.947 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:58:23.958  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:23.959  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485623
2019-03-19/09:58:23.961  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:23.965  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485742
2019-03-19/09:58:23.965  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:23.967  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485862
2019-03-19/09:58:23.967  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:23.969  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_21404_1550506236
2019-03-19/09:58:23.970  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:23.972  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_22881_1550507276
2019-03-19/09:58:23.972  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:23.977  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_24201_1550508248
2019-03-19/09:58:23.977  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:23.981  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_25288_1550509187
2019-03-19/09:58:23.981  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:24.417  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:24.418  INFO: parse.ParseDriver - Parsing command: select name, myq from table1 lateral view explode(qual, gual) q as myq1, myq2
2019-03-19/09:58:24.419  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:25.332 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-19/09:58:25.335  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:25.336  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= '2019-01-01' and command_type = 'HiveCommand' and qlog like 'temp_temp' and   customer_name like '${customer=%}' group by  to_date(qh.created_at)
2019-03-19/09:58:25.337  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:26.198 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-19/09:58:26.623 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-19/09:58:27.124 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-19/09:58:27.131  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:27.131  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-19/09:58:27.134  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:28.860  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:28.862  INFO: parse.ParseDriver - Parsing command: alter table mm_viewability_events_test recover partitions
2019-03-19/09:58:28.875  INFO: parse.ParseDriver - Parsing command: select     report_timestamp,    to_date(report_timestamp) as impression_date,    campaign_name,     a.campaign_id,     strat.goal_type as strategy_goal_type, case when length(delphi_metadata)<1 then 'tree brain'   when delphi_metadata like '%_sb%' then 'shared brain'   when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,     case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag, is_viewable as viewable_impressions,  is_measurable as measurable_impressions,     1 as impressions, clicks as clicks,  total_spend_cpm/1000 as spend, -- sum(total_spend_cpm)/count(a.auction_id) as cpm, -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm, -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate, -- coalesce(sum(clicks)/count(a.auction_id),0) as ctr, -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,     video_start as video_start,     video_complete as video_complete,     pv_conversions,     pc_conversions,     pv_revenue,     pc_revenue,     device,     case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type-- coalesce(sum(video_complete)/sum(video_start),0) as vcr from  (select             report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-19/09:58:29.377  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:29.377  INFO: parse.ParseDriver - Parsing command: select      report_timestamp,     to_date(report_timestamp) as impression_date,     campaign_name,      a.campaign_id,      strat.goal_type as strategy_goal_type,  
case when length(delphi_metadata)<1 then 'tree brain'    
when delphi_metadata like '%_sb%' then 'shared brain'    
when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,      
case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag,  
is_viewable as viewable_impressions,   is_measurable as measurable_impressions,      1 as impressions,  clicks as clicks,   total_spend_cpm/1000 as spend,  
-- sum(total_spend_cpm)/count(a.auction_id) as cpm,  -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm,  -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate,  
-- coalesce(sum(clicks)/count(a.auction_id),0) as ctr,  -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,      video_start as video_start,      
video_complete as video_complete,      pv_conversions,      pc_conversions,      pv_revenue,      pc_revenue,      device,      
case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type 
-- coalesce(sum(video_complete)/sum(video_start),0) as vcr 
  from  (select   report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-19/09:58:29.829  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:29.829  INFO: parse.ParseDriver - Parsing command: select   at.pv_time_lag, at.pixel_id, e.v10, at.campaign_id, at.event_report_timestamp, at.device_type, at.campaign_name, at.event_timestamp_gmt, e.s9, e.s8, at.pixel_name, e.s2, e.s1, e.s7, e.s6, e.s5, e.s4, at.organization_name, at.strategy_name, at.event_date, e.s10, at.agency_id, at.organization_id, e.v1, at.agency_name, e.v3, e.v4, e.v5, e.v6, e.v7, e.v8, e.v9, at.impression_timestamp_gmt, at.advertiser_id, at.pc_time_lag, at.country, e.v2, e.s3, at.strategy_id, at.browser  from   (     select * from     mm_events    ) e   join    (     select * from     mm_attributed_events_ac   ) at   on       e.pixel_id = at.pixel_id       and e.mm_uuid = at.mm_uuid      and e.timestamp_gmt = at.event_timestamp_gmt  where   at.advertiser_id in (206401) and at.organization_id in (101607) and e.organization_id in (101607) and at.agency_id in (117415) and at.pixel_id in (1299912) and at.event_type = 'conversion' and at.event_date between '2019-03-04' and '2019-03-04' and e.event_date between '2019-03-04' and '2019-03-04'
2019-03-19/09:58:29.832  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:30.768 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_events?account_id=5911
2019-03-19/09:58:31.201 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_attributed_events_ac?account_id=5911
2019-03-19/09:58:31.211  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:31.211  INFO: parse.ParseDriver - Parsing command: select  customer,  cluster,  data,  dt,  ingestedtime  from   (select  customer,  cluster,  data,  dt,  ingestedtime,  row_number() over (partition by get_json_object(cluster,'$.clusterid') order by cast(regexp_replace(regexp_replace(ingestedtime, 'T',' '),'Z','') as timestamp) desc) rnum   from dsa_production.aiq_raw_optimized  where dt='2018-01-23'  and source='get_compute_inventory') a   where rnum=1
2019-03-19/09:58:31.216  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:32.243 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/dsa_production/aiq_raw_optimized?account_id=5911
2019-03-19/09:58:32.248  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:32.248  INFO: parse.ParseDriver - Parsing command: SELECT    logdate as the_date,    hour as the_hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold,    SUM(complete100) AS Complete100,    SUM(streams_viewed) AS Streams_viewed  FROM    
(       SELECT          logdate,          hour,          campaign_key,          placement_key,          ad_key,          IF(Isnull(streams_viewed), 0, streams_viewed) AS Streams_viewed,          IF(Isnull(complete100), 0, complete100) AS Complete100        FROM          core.stats_log        WHERE          logdate = '2019-03-10'           and hour = '11'     )    stats     
join       
(          SELECT             campaign_placement.campaign_placement_key AS campaign_placement_key,             campaign_placement.campaign_placement_id AS campaign_placement_id,             campaign_placement.campaign_placement_name AS campaign_placement_name,             opt_metric,             threshold           FROM             promo2.campaign_placement             
 join                
(                   SELECT                      campaign_placement_id,                      opt_metric,                      threshold                    FROM                      promo2.campaign_placement_optimization_filter                    WHERE                      upper(opt_metric) LIKE '%COMPLETIONS_KPI%'                       AND status = 'Active'                )                selected_placements                
 ON campaign_placement.campaign_placement_id = selected_placements.campaign_placement_id       )       selected_placements_decorated       
 ON selected_placements_decorated.campaign_placement_key = stats.placement_key     
join       promo2.ad a        ON stats.ad_key = a.ad_key     GROUP BY    logdate,    hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold
2019-03-19/09:58:32.251  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:33.247 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/core/stats_log?account_id=5911
2019-03-19/09:58:33.667 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement?account_id=5911
2019-03-19/09:58:34.175 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement_optimization_filter?account_id=5911
2019-03-19/09:58:34.570 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/ad?account_id=5911
2019-03-19/09:58:34.575  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:34.575  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-19/09:58:34.576  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:35.876 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-19/09:58:35.884  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:35.884  INFO: parse.ParseDriver - Parsing command: SELECT * FROM foo, LATERAL (SELECT * FROM bar WHERE bar.id = foo.bar_id) ss
2019-03-19/09:58:36.681  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:36.681  INFO: parse.ParseDriver - Parsing command: SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s group by a order by cnt
2019-03-19/09:58:36.682  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:38.251 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-19/09:58:38.253  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:38.259  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:38.259  INFO: parse.ParseDriver - Parsing command: SELECT s.a, b, e, count(s.b) as cnt from (select c as a, d as b from tab1 where c>0 and d<0)s join 
(select a, f from tab2)t on s.a=t.e 
group by s.a, b, e order by cnt
2019-03-19/09:58:38.260  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:39.264 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-19/09:58:39.646 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab2?account_id=5911
2019-03-19/09:58:39.650  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:39.657  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:39.657  INFO: parse.ParseDriver - Parsing command: WITH a AS (
  SELECT substr(name, 1, 3) x FROM tab1 )
SELECT *
FROM a
WHERE x = 'foo'
2019-03-19/09:58:39.658  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:40.638 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-19/09:58:41.076 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/a?account_id=5911
2019-03-19/09:58:41.080  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:41.085  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:41.085  INFO: parse.ParseDriver - Parsing command: SELECT IF(CARDINALITY(my_array) >= 3, my_array[3], NULL)
 FROM tab1
2019-03-19/09:58:41.086  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:42.028 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-19/09:58:42.030  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:42.036  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:42.036  INFO: parse.ParseDriver - Parsing command: select id, ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
2019-03-19/09:58:42.037  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:43.102 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-19/09:58:43.104  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:43.114  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:43.114  INFO: parse.ParseDriver - Parsing command: SELECT student, score
FROM tests CROSS JOIN UNNEST(scores) AS t (score)
2019-03-19/09:58:43.116  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:43.119  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:43.122  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:43.608  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:43.608  INFO: parse.ParseDriver - Parsing command: SELECT distinct tab.X1 AS a, X2 b from tab where a1>0 and a2!=0 and a3=9
2019-03-19/09:58:43.609  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:44.583 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-19/09:58:44.586  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:44.595  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:44.596  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:45.144  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:45.145  INFO: parse.ParseDriver - Parsing command: SELECT *

 FROM DEPT,

 LATERAL TABLE(RAMP(DEPT.DEPTNO)) adid
2019-03-19/09:58:45.164  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:45.693  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:45.694  INFO: parse.ParseDriver - Parsing command: SELECT  ci.id AS cluster_instance_id, ci.cluster_id, unix_timestamp(ci.start_at) AS start_at,  unix_timestamp(ci.down_at) AS down_at, _timestamp AS metric_time, _type AS metric_type,
CASE _type
   WHEN "MEMORY_STATS" THEN arr(total_available_memory, total_used_memory)
   WHEN "VCORES_STATS" THEN arr(total_available_vcores, total_used_vcores)
END AS total 
FROM (SELECT cluster_id, m.total_available_memory, m.total_used_memory, v.total_available_vcores, v.total_used_vcores, e._type, _int(e._timestamp/1000) AS _timestamp FROM processed.yarn 
,LATERAL Table( json_tuple(event_data, 'eventData', 'type', 'timestamp')) AS _eventData, _type, _timestamp 
,LATERAL Table( json_tuple(e._eventData, 'total_memory_mb', 'used_memory_mb'))  total_available_memory, total_used_memory
,LATERAL Table( json_tuple(e._eventData, 'total_vcores', 'used_vcores'))  total_available_vcores, total_used_vcores
WHERE event_date>="$start_date" AND  event_date<"$end_date" AND _type in ("MEMORY_STATS", "VCORES_STATS")) s 
JOIN rstore.cluster_insts ci ON s.cluster_id=ci.cluster_id
WHERE _timestamp BETWEEN unix_timestamp(ci.start_at) AND unix_timestamp(ci.down_at)
2019-03-19/09:58:45.701  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:46.152  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:46.153  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-19/09:58:46.153  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:47.130 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-19/09:58:47.135  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:47.141  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:47.141  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-19/09:58:47.602  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:47.603  INFO: parse.ParseDriver - Parsing command: select id,ts,1+sum(col) over(partition by id order by ts) as rnk
from (select id,ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
     ) t
2019-03-19/09:58:47.603  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:48.523 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-19/09:58:48.527  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:48.538  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:48.538  INFO: parse.ParseDriver - Parsing command: SELECT   JobTitle,
         MaritalStatus,
         AVG(VacationHours)
FROM     HumanResources.Employee AS E
GROUP BY JobTitle, MaritalStatus
HAVING   x in (select x from tab1)
2019-03-19/09:58:48.540  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:49.423 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/humanresources/employee?account_id=5911
2019-03-19/09:58:49.425  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:49.425  INFO: parse.ParseDriver - Parsing command: select venuestate, venueseats, venuename,
first_value(venuename)
over(partition by venuestate
order by venueseats desc
rows between unbounded preceding and unbounded following)
from (select * from venue where venueseats >0)
group by venuestate order by venuestate
2019-03-19/09:58:49.872  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:49.872  INFO: parse.ParseDriver - Parsing command: CREATE TABLE tabx AS SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s
2019-03-19/09:58:49.872  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:50.735 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-19/09:58:50.737  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:50.741  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:50.749  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:50.749  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-19/09:58:50.750  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:51.667 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-19/09:58:52.074 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-19/09:58:52.619 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-19/09:58:52.623  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:52.633  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-19/09:58:52.633  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt
2019-03-19/09:58:52.636  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:53.437 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:58:53.885 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:58:54.299 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:58:54.302  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM table1) v on u.a=v.b
2019-03-19/09:58:54.303  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:54.717 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-19/09:58:55.085 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-19/09:58:55.087  INFO: parse.ParseDriver - Parsing command: SELECT a,b, count(*) from ab where s='jrenv' GROUP BY a, b
2019-03-19/09:58:55.087  INFO: parse.ParseDriver - Parse Completed
2019-03-19/09:58:55.451 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/ab?account_id=5911
2019-03-19/09:58:55.455  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:32:16.545  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:32:16.989  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:44.535  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:45.098  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:46.320  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:46.333  INFO: parse.ParseDriver - Parsing command: SELECT language, account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, language, coalesce(sql, program, cmdline) as sql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id
WHERE query_hist_id is not NULL and sql is not null and length(sql)>50
group by language, account_id
order by cnt desc
2019-03-25/13:40:47.358  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:40:50.074  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.104  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.116  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.161  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.175  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.194  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.214  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.241  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.249  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.267  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.304  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.325  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.333  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.347  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.359  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.366  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.401  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:50.401  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, count(DISTINCT acc_id) as cnt from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id group by 1,2 order by 3
2019-03-25/13:40:50.404  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:40:52.256  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:52.256  INFO: parse.ParseDriver - Parsing command: insert overwrite table tenaliV2.usagemap partition (submit_time, source)
                        select  sub.query, sub.q_id, usagetable.tbl, usagetable.col, usagetable.usg, sub.account_id,
                        sub.submit_time, sub.source as source from (select n.query as query, n.query_hists_id as q_id,
                        n.q_ast as q_ast, n.account_id as account_id, n.submit_time as submit_time, n.source as source from tenaliV2.galaxy
                        as n where n.submit_time in ( '2019-02-20' ) and n.account_id IN (7845,4020) ) as sub lateral view
                        usageUDTFfromHiveTables(sub.query,sub.q_ast, sub.account_id) usagetable as tbl, col, usg
2019-03-25/13:40:52.265  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:40:53.258  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:53.258  INFO: parse.ParseDriver - Parsing command: WITH Sales_CTE 
AS  
-- Define the CTE query  
(  
    SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
    FROM Sales.SalesOrderHeader  
    WHERE SalesPersonID IS NOT NULL  
)  
-- Define the outer query referencing the CTE name.  
SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
FROM Sales_CTE  
GROUP BY SalesYear, SalesPersonID  
ORDER BY SalesPersonID, SalesYear
2019-03-25/13:40:53.262  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:40:54.224 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/sales/salesorderheader?account_id=5911
2019-03-25/13:40:54.237  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:54.237  INFO: parse.ParseDriver - Parsing command: CREATE TABLE myflightinfo2007 AS
    SELECT Year, Month, DepTime, ArrTime, FlightNum, Origin, Dest FROM FlightInfo2007
    WHERE (Month = 7 AND DayofMonth = 3) AND (Origin='JFK' AND Dest='ORD')
2019-03-25/13:40:54.240  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:40:55.186 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/flightinfo2007?account_id=5911
2019-03-25/13:40:55.191  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:55.191  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, s1.id from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id
2019-03-25/13:40:55.193  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:40:57.525  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:57.526  INFO: parse.ParseDriver - Parsing command: SELECT account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, coalesce(program, cmdline) as qsql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id 
WHERE query_hist_id is not NULL and qsql is not null and length(qsql)>50
group by account_id
order by 1 desc
2019-03-25/13:40:57.529  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:40:59.994  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:40:59.994  INFO: parse.ParseDriver - Parsing command: SELECT id, get_json(u.json, 'location') as info, to_date(created_at) as dt FROM db_users u JOIN (SELECT by_date.location, dt, num_users * 1000.0 / total_users as frac_of_location, num_users, total_users FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt limit 100
2019-03-25/13:41:00.005  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:00.955 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/13:41:01.445 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/13:41:01.881 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/13:41:01.891  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:01.891  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485623
2019-03-25/13:41:01.892  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:01.894  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485742
2019-03-25/13:41:01.894  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:01.897  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485862
2019-03-25/13:41:01.897  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:01.899  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_21404_1550506236
2019-03-25/13:41:01.899  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:01.901  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_22881_1550507276
2019-03-25/13:41:01.902  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:01.904  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_24201_1550508248
2019-03-25/13:41:01.904  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:01.905  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_25288_1550509187
2019-03-25/13:41:01.906  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:02.372  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:02.372  INFO: parse.ParseDriver - Parsing command: select name, myq from table1 lateral view explode(qual, gual) q as myq1, myq2
2019-03-25/13:41:02.373  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:03.466 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-25/13:41:03.471  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:03.472  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= '2019-01-01' and command_type = 'HiveCommand' and qlog like 'temp_temp' and   customer_name like '${customer=%}' group by  to_date(qh.created_at)
2019-03-25/13:41:03.473  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:04.474 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/13:41:04.886 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/13:41:05.328 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/13:41:05.334  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:05.334  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-25/13:41:05.337  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:07.600  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:07.600  INFO: parse.ParseDriver - Parsing command: alter table mm_viewability_events_test recover partitions
2019-03-25/13:41:07.609  INFO: parse.ParseDriver - Parsing command: select     report_timestamp,    to_date(report_timestamp) as impression_date,    campaign_name,     a.campaign_id,     strat.goal_type as strategy_goal_type, case when length(delphi_metadata)<1 then 'tree brain'   when delphi_metadata like '%_sb%' then 'shared brain'   when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,     case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag, is_viewable as viewable_impressions,  is_measurable as measurable_impressions,     1 as impressions, clicks as clicks,  total_spend_cpm/1000 as spend, -- sum(total_spend_cpm)/count(a.auction_id) as cpm, -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm, -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate, -- coalesce(sum(clicks)/count(a.auction_id),0) as ctr, -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,     video_start as video_start,     video_complete as video_complete,     pv_conversions,     pc_conversions,     pv_revenue,     pc_revenue,     device,     case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type-- coalesce(sum(video_complete)/sum(video_start),0) as vcr from  (select             report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-25/13:41:08.086  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:08.087  INFO: parse.ParseDriver - Parsing command: select      report_timestamp,     to_date(report_timestamp) as impression_date,     campaign_name,      a.campaign_id,      strat.goal_type as strategy_goal_type,  
case when length(delphi_metadata)<1 then 'tree brain'    
when delphi_metadata like '%_sb%' then 'shared brain'    
when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,      
case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag,  
is_viewable as viewable_impressions,   is_measurable as measurable_impressions,      1 as impressions,  clicks as clicks,   total_spend_cpm/1000 as spend,  
-- sum(total_spend_cpm)/count(a.auction_id) as cpm,  -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm,  -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate,  
-- coalesce(sum(clicks)/count(a.auction_id),0) as ctr,  -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,      video_start as video_start,      
video_complete as video_complete,      pv_conversions,      pc_conversions,      pv_revenue,      pc_revenue,      device,      
case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type 
-- coalesce(sum(video_complete)/sum(video_start),0) as vcr 
  from  (select   report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-25/13:41:08.636  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:08.636  INFO: parse.ParseDriver - Parsing command: select   at.pv_time_lag, at.pixel_id, e.v10, at.campaign_id, at.event_report_timestamp, at.device_type, at.campaign_name, at.event_timestamp_gmt, e.s9, e.s8, at.pixel_name, e.s2, e.s1, e.s7, e.s6, e.s5, e.s4, at.organization_name, at.strategy_name, at.event_date, e.s10, at.agency_id, at.organization_id, e.v1, at.agency_name, e.v3, e.v4, e.v5, e.v6, e.v7, e.v8, e.v9, at.impression_timestamp_gmt, at.advertiser_id, at.pc_time_lag, at.country, e.v2, e.s3, at.strategy_id, at.browser  from   (     select * from     mm_events    ) e   join    (     select * from     mm_attributed_events_ac   ) at   on       e.pixel_id = at.pixel_id       and e.mm_uuid = at.mm_uuid      and e.timestamp_gmt = at.event_timestamp_gmt  where   at.advertiser_id in (206401) and at.organization_id in (101607) and e.organization_id in (101607) and at.agency_id in (117415) and at.pixel_id in (1299912) and at.event_type = 'conversion' and at.event_date between '2019-03-04' and '2019-03-04' and e.event_date between '2019-03-04' and '2019-03-04'
2019-03-25/13:41:08.639  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:09.596 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_events?account_id=5911
2019-03-25/13:41:10.053 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_attributed_events_ac?account_id=5911
2019-03-25/13:41:10.059  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:10.059  INFO: parse.ParseDriver - Parsing command: select  customer,  cluster,  data,  dt,  ingestedtime  from   (select  customer,  cluster,  data,  dt,  ingestedtime,  row_number() over (partition by get_json_object(cluster,'$.clusterid') order by cast(regexp_replace(regexp_replace(ingestedtime, 'T',' '),'Z','') as timestamp) desc) rnum   from dsa_production.aiq_raw_optimized  where dt='2018-01-23'  and source='get_compute_inventory') a   where rnum=1
2019-03-25/13:41:10.063  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:11.065 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/dsa_production/aiq_raw_optimized?account_id=5911
2019-03-25/13:41:11.069  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:11.069  INFO: parse.ParseDriver - Parsing command: SELECT    logdate as the_date,    hour as the_hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold,    SUM(complete100) AS Complete100,    SUM(streams_viewed) AS Streams_viewed  FROM    
(       SELECT          logdate,          hour,          campaign_key,          placement_key,          ad_key,          IF(Isnull(streams_viewed), 0, streams_viewed) AS Streams_viewed,          IF(Isnull(complete100), 0, complete100) AS Complete100        FROM          core.stats_log        WHERE          logdate = '2019-03-10'           and hour = '11'     )    stats     
join       
(          SELECT             campaign_placement.campaign_placement_key AS campaign_placement_key,             campaign_placement.campaign_placement_id AS campaign_placement_id,             campaign_placement.campaign_placement_name AS campaign_placement_name,             opt_metric,             threshold           FROM             promo2.campaign_placement             
 join                
(                   SELECT                      campaign_placement_id,                      opt_metric,                      threshold                    FROM                      promo2.campaign_placement_optimization_filter                    WHERE                      upper(opt_metric) LIKE '%COMPLETIONS_KPI%'                       AND status = 'Active'                )                selected_placements                
 ON campaign_placement.campaign_placement_id = selected_placements.campaign_placement_id       )       selected_placements_decorated       
 ON selected_placements_decorated.campaign_placement_key = stats.placement_key     
join       promo2.ad a        ON stats.ad_key = a.ad_key     GROUP BY    logdate,    hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold
2019-03-25/13:41:11.071  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:12.174 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/core/stats_log?account_id=5911
2019-03-25/13:41:12.616 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement?account_id=5911
2019-03-25/13:41:13.062 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement_optimization_filter?account_id=5911
2019-03-25/13:41:13.494 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/ad?account_id=5911
2019-03-25/13:41:13.500  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:13.500  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/13:41:13.501  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:14.381 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/13:41:14.390  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:14.390  INFO: parse.ParseDriver - Parsing command: SELECT * FROM foo, LATERAL (SELECT * FROM bar WHERE bar.id = foo.bar_id) ss
2019-03-25/13:41:14.872  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:14.872  INFO: parse.ParseDriver - Parsing command: SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s group by a order by cnt
2019-03-25/13:41:14.873  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:15.850 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/13:41:15.853  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:15.860  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:15.860  INFO: parse.ParseDriver - Parsing command: SELECT s.a, b, e, count(s.b) as cnt from (select c as a, d as b from tab1 where c>0 and d<0)s join 
(select a, f from tab2)t on s.a=t.e 
group by s.a, b, e order by cnt
2019-03-25/13:41:15.861  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:16.734 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/13:41:17.199 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab2?account_id=5911
2019-03-25/13:41:17.203  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:17.210  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:17.210  INFO: parse.ParseDriver - Parsing command: WITH a AS (
  SELECT substr(name, 1, 3) x FROM tab1 )
SELECT *
FROM a
WHERE x = 'foo'
2019-03-25/13:41:17.211  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:18.232 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/13:41:18.698 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/a?account_id=5911
2019-03-25/13:41:18.701  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:18.705  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:18.705  INFO: parse.ParseDriver - Parsing command: SELECT IF(CARDINALITY(my_array) >= 3, my_array[3], NULL)
 FROM tab1
2019-03-25/13:41:18.706  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:19.763 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/13:41:19.766  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:19.771  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:19.771  INFO: parse.ParseDriver - Parsing command: select id, ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
2019-03-25/13:41:19.773  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:20.708 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-25/13:41:20.711  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:20.720  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:20.720  INFO: parse.ParseDriver - Parsing command: SELECT student, score
FROM tests CROSS JOIN UNNEST(scores) AS t (score)
2019-03-25/13:41:20.722  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:20.725  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:20.727  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:21.197  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:21.197  INFO: parse.ParseDriver - Parsing command: SELECT distinct tab.X1 AS a, X2 b from tab where a1>0 and a2!=0 and a3=9
2019-03-25/13:41:21.198  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:22.185 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/13:41:22.188  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:22.197  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:22.198  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:22.656  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:22.656  INFO: parse.ParseDriver - Parsing command: SELECT *

 FROM DEPT,

 LATERAL TABLE(RAMP(DEPT.DEPTNO)) adid
2019-03-25/13:41:22.674  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:23.177  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:23.177  INFO: parse.ParseDriver - Parsing command: SELECT  ci.id AS cluster_instance_id, ci.cluster_id, unix_timestamp(ci.start_at) AS start_at,  unix_timestamp(ci.down_at) AS down_at, _timestamp AS metric_time, _type AS metric_type,
CASE _type
   WHEN "MEMORY_STATS" THEN arr(total_available_memory, total_used_memory)
   WHEN "VCORES_STATS" THEN arr(total_available_vcores, total_used_vcores)
END AS total 
FROM (SELECT cluster_id, m.total_available_memory, m.total_used_memory, v.total_available_vcores, v.total_used_vcores, e._type, _int(e._timestamp/1000) AS _timestamp FROM processed.yarn 
,LATERAL Table( json_tuple(event_data, 'eventData', 'type', 'timestamp')) AS _eventData, _type, _timestamp 
,LATERAL Table( json_tuple(e._eventData, 'total_memory_mb', 'used_memory_mb'))  total_available_memory, total_used_memory
,LATERAL Table( json_tuple(e._eventData, 'total_vcores', 'used_vcores'))  total_available_vcores, total_used_vcores
WHERE event_date>="$start_date" AND  event_date<"$end_date" AND _type in ("MEMORY_STATS", "VCORES_STATS")) s 
JOIN rstore.cluster_insts ci ON s.cluster_id=ci.cluster_id
WHERE _timestamp BETWEEN unix_timestamp(ci.start_at) AND unix_timestamp(ci.down_at)
2019-03-25/13:41:23.182  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:23.655  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:23.655  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/13:41:23.656  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:24.713 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/13:41:24.716  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:24.757  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:24.757  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-25/13:41:25.295  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:25.295  INFO: parse.ParseDriver - Parsing command: select id,ts,1+sum(col) over(partition by id order by ts) as rnk
from (select id,ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
     ) t
2019-03-25/13:41:25.295  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:26.180 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-25/13:41:26.183  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:26.193  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:26.193  INFO: parse.ParseDriver - Parsing command: SELECT   JobTitle,
         MaritalStatus,
         AVG(VacationHours)
FROM     HumanResources.Employee AS E
GROUP BY JobTitle, MaritalStatus
HAVING   x in (select x from tab1)
2019-03-25/13:41:26.194  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:27.114 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/humanresources/employee?account_id=5911
2019-03-25/13:41:27.117  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:27.117  INFO: parse.ParseDriver - Parsing command: select venuestate, venueseats, venuename,
first_value(venuename)
over(partition by venuestate
order by venueseats desc
rows between unbounded preceding and unbounded following)
from (select * from venue where venueseats >0)
group by venuestate order by venuestate
2019-03-25/13:41:27.624  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:27.624  INFO: parse.ParseDriver - Parsing command: CREATE TABLE tabx AS SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s
2019-03-25/13:41:27.625  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:28.592 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/13:41:28.594  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:28.601  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:28.612  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:28.612  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/13:41:28.613  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:29.648 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/13:41:30.046 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/13:41:30.422 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/13:41:30.426  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:30.433  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:41:30.433  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt
2019-03-25/13:41:30.434  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:31.504 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/13:41:31.993 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/13:41:32.476 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/13:41:32.479  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM table1) v on u.a=v.b
2019-03-25/13:41:32.480  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:32.919 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/13:41:33.344 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-25/13:41:33.348  INFO: parse.ParseDriver - Parsing command: SELECT a,b, count(*) from ab where s='jrenv' GROUP BY a, b
2019-03-25/13:41:33.349  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:41:33.758 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/ab?account_id=5911
2019-03-25/13:41:33.762  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:46:25.852  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:46:25.867  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-25/13:47:18.204  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:47:18.219  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') sAND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-25/13:47:19.611  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:47:32.818  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:47:32.832  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') s AND logdate>'2015-09-01') GROUP BY logdate, site_key, survey_id
2019-03-25/13:47:34.340  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:47:54.318  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:47:54.332  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01') s GROUP BY logdate, site_key, survey_id
2019-03-25/13:47:55.312  INFO: parse.ParseDriver - Parse Completed
2019-03-25/13:47:56.261 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/13:47:56.680  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:48:18.536  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:48:18.550  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01')  GROUP BY logdate, site_key, survey_id
2019-03-25/13:48:50.313  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/13:48:50.331  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id FROM ( select count(*) from marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01')  GROUP BY logdate, site_key, survey_id
2019-03-25/13:49:03.120  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:04:57.759  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:04:57.774  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:04:58.753  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:05:01.846 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:05:02.243  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:13:56.644  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:13:57.459  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:13:58.965  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:13:58.979  INFO: parse.ParseDriver - Parsing command: SELECT language, account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, language, coalesce(sql, program, cmdline) as sql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id
WHERE query_hist_id is not NULL and sql is not null and length(sql)>50
group by language, account_id
order by cnt desc
2019-03-25/14:14:00.120  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:02.743  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.768  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.779  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.825  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.841  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.864  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.881  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.907  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.917  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.937  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:02.988  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:03.030  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:03.036  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:03.054  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:03.075  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:03.083  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:03.111  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:03.111  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, count(DISTINCT acc_id) as cnt from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id group by 1,2 order by 3
2019-03-25/14:14:03.114  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:04.919  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:04.919  INFO: parse.ParseDriver - Parsing command: insert overwrite table tenaliV2.usagemap partition (submit_time, source)
                        select  sub.query, sub.q_id, usagetable.tbl, usagetable.col, usagetable.usg, sub.account_id,
                        sub.submit_time, sub.source as source from (select n.query as query, n.query_hists_id as q_id,
                        n.q_ast as q_ast, n.account_id as account_id, n.submit_time as submit_time, n.source as source from tenaliV2.galaxy
                        as n where n.submit_time in ( '2019-02-20' ) and n.account_id IN (7845,4020) ) as sub lateral view
                        usageUDTFfromHiveTables(sub.query,sub.q_ast, sub.account_id) usagetable as tbl, col, usg
2019-03-25/14:14:04.928  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:05.807  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:05.807  INFO: parse.ParseDriver - Parsing command: WITH Sales_CTE 
AS  
-- Define the CTE query  
(  
    SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
    FROM Sales.SalesOrderHeader  
    WHERE SalesPersonID IS NOT NULL  
)  
-- Define the outer query referencing the CTE name.  
SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
FROM Sales_CTE  
GROUP BY SalesYear, SalesPersonID  
ORDER BY SalesPersonID, SalesYear
2019-03-25/14:14:05.811  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:06.756 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/sales/salesorderheader?account_id=5911
2019-03-25/14:14:06.767  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:06.767  INFO: parse.ParseDriver - Parsing command: CREATE TABLE myflightinfo2007 AS
    SELECT Year, Month, DepTime, ArrTime, FlightNum, Origin, Dest FROM FlightInfo2007
    WHERE (Month = 7 AND DayofMonth = 3) AND (Origin='JFK' AND Dest='ORD')
2019-03-25/14:14:06.769  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:07.884 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/flightinfo2007?account_id=5911
2019-03-25/14:14:07.889  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:07.889  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, s1.id from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id
2019-03-25/14:14:07.891  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:09.740  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:09.740  INFO: parse.ParseDriver - Parsing command: SELECT account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, coalesce(program, cmdline) as qsql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id 
WHERE query_hist_id is not NULL and qsql is not null and length(qsql)>50
group by account_id
order by 1 desc
2019-03-25/14:14:09.746  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:12.251  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:12.251  INFO: parse.ParseDriver - Parsing command: SELECT id, get_json(u.json, 'location') as info, to_date(created_at) as dt FROM db_users u JOIN (SELECT by_date.location, dt, num_users * 1000.0 / total_users as frac_of_location, num_users, total_users FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt limit 100
2019-03-25/14:14:12.263  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:13.184 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:14:13.617 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:14:14.025 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:14:14.036  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:14.036  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485623
2019-03-25/14:14:14.037  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:14.039  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485742
2019-03-25/14:14:14.039  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:14.041  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485862
2019-03-25/14:14:14.041  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:14.043  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_21404_1550506236
2019-03-25/14:14:14.043  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:14.045  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_22881_1550507276
2019-03-25/14:14:14.045  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:14.047  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_24201_1550508248
2019-03-25/14:14:14.047  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:14.049  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_25288_1550509187
2019-03-25/14:14:14.049  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:14.504  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:14.504  INFO: parse.ParseDriver - Parsing command: select name, myq from table1 lateral view explode(qual, gual) q as myq1, myq2
2019-03-25/14:14:14.505  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:15.561 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-25/14:14:15.565  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:15.565  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= '2019-01-01' and command_type = 'HiveCommand' and qlog like 'temp_temp' and   customer_name like '${customer=%}' group by  to_date(qh.created_at)
2019-03-25/14:14:15.567  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:16.471 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:14:16.959 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:14:17.379 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:14:17.385  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:17.385  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-25/14:14:17.388  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:19.236  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:19.236  INFO: parse.ParseDriver - Parsing command: alter table mm_viewability_events_test recover partitions
2019-03-25/14:14:19.245  INFO: parse.ParseDriver - Parsing command: select     report_timestamp,    to_date(report_timestamp) as impression_date,    campaign_name,     a.campaign_id,     strat.goal_type as strategy_goal_type, case when length(delphi_metadata)<1 then 'tree brain'   when delphi_metadata like '%_sb%' then 'shared brain'   when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,     case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag, is_viewable as viewable_impressions,  is_measurable as measurable_impressions,     1 as impressions, clicks as clicks,  total_spend_cpm/1000 as spend, -- sum(total_spend_cpm)/count(a.auction_id) as cpm, -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm, -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate, -- coalesce(sum(clicks)/count(a.auction_id),0) as ctr, -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,     video_start as video_start,     video_complete as video_complete,     pv_conversions,     pc_conversions,     pv_revenue,     pc_revenue,     device,     case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type-- coalesce(sum(video_complete)/sum(video_start),0) as vcr from  (select             report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-25/14:14:19.783  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:19.783  INFO: parse.ParseDriver - Parsing command: select      report_timestamp,     to_date(report_timestamp) as impression_date,     campaign_name,      a.campaign_id,      strat.goal_type as strategy_goal_type,  
case when length(delphi_metadata)<1 then 'tree brain'    
when delphi_metadata like '%_sb%' then 'shared brain'    
when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,      
case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag,  
is_viewable as viewable_impressions,   is_measurable as measurable_impressions,      1 as impressions,  clicks as clicks,   total_spend_cpm/1000 as spend,  
-- sum(total_spend_cpm)/count(a.auction_id) as cpm,  -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm,  -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate,  
-- coalesce(sum(clicks)/count(a.auction_id),0) as ctr,  -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,      video_start as video_start,      
video_complete as video_complete,      pv_conversions,      pc_conversions,      pv_revenue,      pc_revenue,      device,      
case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type 
-- coalesce(sum(video_complete)/sum(video_start),0) as vcr 
  from  (select   report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-25/14:14:20.272  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:20.272  INFO: parse.ParseDriver - Parsing command: select   at.pv_time_lag, at.pixel_id, e.v10, at.campaign_id, at.event_report_timestamp, at.device_type, at.campaign_name, at.event_timestamp_gmt, e.s9, e.s8, at.pixel_name, e.s2, e.s1, e.s7, e.s6, e.s5, e.s4, at.organization_name, at.strategy_name, at.event_date, e.s10, at.agency_id, at.organization_id, e.v1, at.agency_name, e.v3, e.v4, e.v5, e.v6, e.v7, e.v8, e.v9, at.impression_timestamp_gmt, at.advertiser_id, at.pc_time_lag, at.country, e.v2, e.s3, at.strategy_id, at.browser  from   (     select * from     mm_events    ) e   join    (     select * from     mm_attributed_events_ac   ) at   on       e.pixel_id = at.pixel_id       and e.mm_uuid = at.mm_uuid      and e.timestamp_gmt = at.event_timestamp_gmt  where   at.advertiser_id in (206401) and at.organization_id in (101607) and e.organization_id in (101607) and at.agency_id in (117415) and at.pixel_id in (1299912) and at.event_type = 'conversion' and at.event_date between '2019-03-04' and '2019-03-04' and e.event_date between '2019-03-04' and '2019-03-04'
2019-03-25/14:14:20.275  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:21.398 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_events?account_id=5911
2019-03-25/14:14:21.862 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_attributed_events_ac?account_id=5911
2019-03-25/14:14:21.869  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:21.869  INFO: parse.ParseDriver - Parsing command: select  customer,  cluster,  data,  dt,  ingestedtime  from   (select  customer,  cluster,  data,  dt,  ingestedtime,  row_number() over (partition by get_json_object(cluster,'$.clusterid') order by cast(regexp_replace(regexp_replace(ingestedtime, 'T',' '),'Z','') as timestamp) desc) rnum   from dsa_production.aiq_raw_optimized  where dt='2018-01-23'  and source='get_compute_inventory') a   where rnum=1
2019-03-25/14:14:21.872  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:22.841 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/dsa_production/aiq_raw_optimized?account_id=5911
2019-03-25/14:14:22.846  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:22.846  INFO: parse.ParseDriver - Parsing command: SELECT    logdate as the_date,    hour as the_hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold,    SUM(complete100) AS Complete100,    SUM(streams_viewed) AS Streams_viewed  FROM    
(       SELECT          logdate,          hour,          campaign_key,          placement_key,          ad_key,          IF(Isnull(streams_viewed), 0, streams_viewed) AS Streams_viewed,          IF(Isnull(complete100), 0, complete100) AS Complete100        FROM          core.stats_log        WHERE          logdate = '2019-03-10'           and hour = '11'     )    stats     
join       
(          SELECT             campaign_placement.campaign_placement_key AS campaign_placement_key,             campaign_placement.campaign_placement_id AS campaign_placement_id,             campaign_placement.campaign_placement_name AS campaign_placement_name,             opt_metric,             threshold           FROM             promo2.campaign_placement             
 join                
(                   SELECT                      campaign_placement_id,                      opt_metric,                      threshold                    FROM                      promo2.campaign_placement_optimization_filter                    WHERE                      upper(opt_metric) LIKE '%COMPLETIONS_KPI%'                       AND status = 'Active'                )                selected_placements                
 ON campaign_placement.campaign_placement_id = selected_placements.campaign_placement_id       )       selected_placements_decorated       
 ON selected_placements_decorated.campaign_placement_key = stats.placement_key     
join       promo2.ad a        ON stats.ad_key = a.ad_key     GROUP BY    logdate,    hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold
2019-03-25/14:14:22.849  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:23.802 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/core/stats_log?account_id=5911
2019-03-25/14:14:24.187 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement?account_id=5911
2019-03-25/14:14:24.806 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement_optimization_filter?account_id=5911
2019-03-25/14:14:25.226 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/ad?account_id=5911
2019-03-25/14:14:25.231  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:25.231  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:14:25.232  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:26.054 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:14:26.060  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:26.060  INFO: parse.ParseDriver - Parsing command: SELECT * FROM foo, LATERAL (SELECT * FROM bar WHERE bar.id = foo.bar_id) ss
2019-03-25/14:14:26.542  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:26.542  INFO: parse.ParseDriver - Parsing command: SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s group by a order by cnt
2019-03-25/14:14:26.543  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:27.497 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/14:14:27.502  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:27.508  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:27.508  INFO: parse.ParseDriver - Parsing command: SELECT s.a, b, e, count(s.b) as cnt from (select c as a, d as b from tab1 where c>0 and d<0)s join 
(select a, f from tab2)t on s.a=t.e 
group by s.a, b, e order by cnt
2019-03-25/14:14:27.509  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:28.387 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/14:14:28.818 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab2?account_id=5911
2019-03-25/14:14:28.821  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:28.831  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:28.831  INFO: parse.ParseDriver - Parsing command: WITH a AS (
  SELECT substr(name, 1, 3) x FROM tab1 )
SELECT *
FROM a
WHERE x = 'foo'
2019-03-25/14:14:28.831  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:29.712 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/14:14:30.087 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/a?account_id=5911
2019-03-25/14:14:30.090  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:30.097  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:30.097  INFO: parse.ParseDriver - Parsing command: SELECT IF(CARDINALITY(my_array) >= 3, my_array[3], NULL)
 FROM tab1
2019-03-25/14:14:30.098  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:31.015 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/14:14:31.019  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:31.025  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:31.025  INFO: parse.ParseDriver - Parsing command: select id, ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
2019-03-25/14:14:31.027  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:32.088 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-25/14:14:32.090  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:32.100  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:32.100  INFO: parse.ParseDriver - Parsing command: SELECT student, score
FROM tests CROSS JOIN UNNEST(scores) AS t (score)
2019-03-25/14:14:32.102  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:32.105  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:32.108  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:32.575  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:32.575  INFO: parse.ParseDriver - Parsing command: SELECT distinct tab.X1 AS a, X2 b from tab where a1>0 and a2!=0 and a3=9
2019-03-25/14:14:32.576  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:33.446 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/14:14:33.449  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:33.456  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:33.456  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:14:33.457  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:34.432 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:14:34.436  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:34.545 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-25/14:14:34.550 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-25/14:14:34.558  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:34.558  INFO: parse.ParseDriver - Parsing command: SELECT *

 FROM DEPT,

 LATERAL TABLE(RAMP(DEPT.DEPTNO)) adid
2019-03-25/14:14:34.563  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:35.043  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:35.043  INFO: parse.ParseDriver - Parsing command: SELECT  ci.id AS cluster_instance_id, ci.cluster_id, unix_timestamp(ci.start_at) AS start_at,  unix_timestamp(ci.down_at) AS down_at, _timestamp AS metric_time, _type AS metric_type,
CASE _type
   WHEN "MEMORY_STATS" THEN arr(total_available_memory, total_used_memory)
   WHEN "VCORES_STATS" THEN arr(total_available_vcores, total_used_vcores)
END AS total 
FROM (SELECT cluster_id, m.total_available_memory, m.total_used_memory, v.total_available_vcores, v.total_used_vcores, e._type, _int(e._timestamp/1000) AS _timestamp FROM processed.yarn 
,LATERAL Table( json_tuple(event_data, 'eventData', 'type', 'timestamp')) AS _eventData, _type, _timestamp 
,LATERAL Table( json_tuple(e._eventData, 'total_memory_mb', 'used_memory_mb'))  total_available_memory, total_used_memory
,LATERAL Table( json_tuple(e._eventData, 'total_vcores', 'used_vcores'))  total_available_vcores, total_used_vcores
WHERE event_date>="$start_date" AND  event_date<"$end_date" AND _type in ("MEMORY_STATS", "VCORES_STATS")) s 
JOIN rstore.cluster_insts ci ON s.cluster_id=ci.cluster_id
WHERE _timestamp BETWEEN unix_timestamp(ci.start_at) AND unix_timestamp(ci.down_at)
2019-03-25/14:14:35.053  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:35.532  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:35.532  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:14:35.533  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:36.433 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:14:36.436  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:36.438 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-25/14:14:36.439 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-25/14:14:36.443  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:36.449  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:36.449  INFO: parse.ParseDriver - Parsing command: select id,ts,1+sum(col) over(partition by id order by ts) as rnk
from (select id,ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
     ) t
2019-03-25/14:14:36.450  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:37.333 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-25/14:14:37.337  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:37.345  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:37.345  INFO: parse.ParseDriver - Parsing command: SELECT   JobTitle,
         MaritalStatus,
         AVG(VacationHours)
FROM     HumanResources.Employee AS E
GROUP BY JobTitle, MaritalStatus
HAVING   x in (select x from tab1)
2019-03-25/14:14:37.348  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:38.206 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/humanresources/employee?account_id=5911
2019-03-25/14:14:38.209  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:38.209  INFO: parse.ParseDriver - Parsing command: select venuestate, venueseats, venuename,
first_value(venuename)
over(partition by venuestate
order by venueseats desc
rows between unbounded preceding and unbounded following)
from (select * from venue where venueseats >0)
group by venuestate order by venuestate
2019-03-25/14:14:38.682  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:38.682  INFO: parse.ParseDriver - Parsing command: CREATE TABLE tabx AS SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s
2019-03-25/14:14:38.682  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:39.586 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/14:14:39.588  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:39.592  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:39.603  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:39.603  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:14:39.604  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:40.483 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:14:40.485  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/14:14:40.487  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:40.959 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:14:41.381 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:14:41.776 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:14:41.780  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:41.785  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:14:41.785  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt
2019-03-25/14:14:41.805  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:42.704 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:14:43.119 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:14:43.555 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:14:43.558  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM table1) v on u.a=v.b
2019-03-25/14:14:43.559  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:44.001 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:14:44.404 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-25/14:14:44.407  INFO: parse.ParseDriver - Parsing command: SELECT a,b, count(*) from ab where s='jrenv' GROUP BY a, b
2019-03-25/14:14:44.408  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:14:44.801 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/ab?account_id=5911
2019-03-25/14:14:44.805  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:15:37.090  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:15:37.106  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:15:38.102  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:15:39.076 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:15:39.493  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:15:40.037 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-25/14:15:40.039 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-25/14:16:06.860  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:16:06.874  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:16:07.847  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:16:08.875 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:16:09.276  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:16:09.781 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-25/14:16:09.784 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-25/14:16:24.326  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:16:24.339  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:16:25.326  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:16:26.372 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:16:26.389  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/14:16:26.396  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:16:26.812 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:16:27.200 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:16:27.607 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:16:28.006  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:34:00.322  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:34:00.338  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:34:01.337  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:34:02.432 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:34:02.451  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/14:34:02.459  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:34:02.888 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:34:03.281 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:34:03.672 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:46:11.071  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:46:11.086  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing. stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:46:12.093  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:46:13.148 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:46:13.171  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/14:46:13.177  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:46:13.632 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:46:14.073 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:46:14.483 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:50:19.043  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:19.596  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:20.879  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:20.892  INFO: parse.ParseDriver - Parsing command: SELECT language, account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, language, coalesce(sql, program, cmdline) as sql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id
WHERE query_hist_id is not NULL and sql is not null and length(sql)>50
group by language, account_id
order by cnt desc
2019-03-25/14:50:21.860  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:24.499  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.530  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.543  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.597  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.613  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.649  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.672  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.686  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.694  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.712  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.758  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.803  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.814  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.835  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.848  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.853  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.895  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:24.896  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, count(DISTINCT acc_id) as cnt from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id group by 1,2 order by 3
2019-03-25/14:50:24.899  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:26.872  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:26.872  INFO: parse.ParseDriver - Parsing command: insert overwrite table tenaliV2.usagemap partition (submit_time, source)
                        select  sub.query, sub.q_id, usagetable.tbl, usagetable.col, usagetable.usg, sub.account_id,
                        sub.submit_time, sub.source as source from (select n.query as query, n.query_hists_id as q_id,
                        n.q_ast as q_ast, n.account_id as account_id, n.submit_time as submit_time, n.source as source from tenaliV2.galaxy
                        as n where n.submit_time in ( '2019-02-20' ) and n.account_id IN (7845,4020) ) as sub lateral view
                        usageUDTFfromHiveTables(sub.query,sub.q_ast, sub.account_id) usagetable as tbl, col, usg
2019-03-25/14:50:26.879  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:27.941  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:27.941  INFO: parse.ParseDriver - Parsing command: WITH Sales_CTE 
AS  
-- Define the CTE query  
(  
    SELECT SalesPersonID, SalesOrderID, YEAR(OrderDate) AS SalesYear  
    FROM Sales.SalesOrderHeader  
    WHERE SalesPersonID IS NOT NULL  
)  
-- Define the outer query referencing the CTE name.  
SELECT SalesPersonID, COUNT(SalesOrderID) AS TotalSales, SalesYear  
FROM Sales_CTE  
GROUP BY SalesYear, SalesPersonID  
ORDER BY SalesPersonID, SalesYear
2019-03-25/14:50:27.944  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:28.941 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/sales/salesorderheader?account_id=5911
2019-03-25/14:50:28.955  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:28.956  INFO: parse.ParseDriver - Parsing command: CREATE TABLE myflightinfo2007 AS
    SELECT Year, Month, DepTime, ArrTime, FlightNum, Origin, Dest FROM FlightInfo2007
    WHERE (Month = 7 AND DayofMonth = 3) AND (Origin='JFK' AND Dest='ORD')
2019-03-25/14:50:28.958  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:29.913 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/flightinfo2007?account_id=5911
2019-03-25/14:50:29.918  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:29.918  INFO: parse.ParseDriver - Parsing command: select s2.acc_id, tag1, s1.id from (select tab1.account_id acc_id, tab1.tag tag1, tab2.id from rstore.query_hists tab1 join rstore.cluster_nodes  tab2 on tab1.account_id=tab2.account_id where tab2.account_id>0) s1 join (select id, account_id as acc_id, created_at, deleted_at from rstore.clusters where id>100) s2 on s1.acc_id=s2.acc_id
2019-03-25/14:50:29.920  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:31.879  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:31.879  INFO: parse.ParseDriver - Parsing command: SELECT account_id, count(*) as cnt FROM 
(SELECT h.id AS id, h.dt, h.account_id, h.status, coalesce(program, cmdline) as qsql FROM rstore.query_hists h JOIN rstore.spark_commands s ON h.command_id=s.id and h.dt=s.dt AND h.dt>='2019-02-01' AND status='done') y
LEFT JOIN
(SELECT DISTINCT query_hist_id, sql_app_id, command_id
   FROM (SELECT account_id, command_id, cluster_id, cluster_inst_id, json_extract(event_data,'$.executedQueryInfo.applicationId') as sql_app_id,  
		 json_extract(event_data,'$.executedQueryInfo.queryhistId') as query_hist_id, json_extract(event_data,'$.executedQueryInfo.status') AS status, json_extract(event_data,'$.executedQueryInfo.timeTakenMs') as time_taken FROM processed_v2.spark WHERE event_date>='2019-02-01' AND event_type='CLUSTER.SPARK.METRICS.SQL')s
    LEFT JOIN
    (SELECT json_extract(event_data,'$.id') AS metric_app_id FROM processed_v2.spark WHERE event_date>='2019-02-01' AND 
     event_type='CLUSTER.SPARK.METRICS') t
    ON s.sql_app_id = t.metric_app_id) x
ON x.query_hist_id = y.id 
WHERE query_hist_id is not NULL and qsql is not null and length(qsql)>50
group by account_id
order by 1 desc
2019-03-25/14:50:31.887  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:34.442  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:34.442  INFO: parse.ParseDriver - Parsing command: SELECT id, get_json(u.json, 'location') as info, to_date(created_at) as dt FROM db_users u JOIN (SELECT by_date.location, dt, num_users * 1000.0 / total_users as frac_of_location, num_users, total_users FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt limit 100
2019-03-25/14:50:34.452  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:35.415 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:50:35.878 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:50:36.293 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:50:36.302  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:36.302  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485623
2019-03-25/14:50:36.303  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:36.305  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485742
2019-03-25/14:50:36.306  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:36.308  INFO: parse.ParseDriver - Parsing command: drop table if exists tmp_klynch_ebay_conversions_1550485862
2019-03-25/14:50:36.308  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:36.310  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_21404_1550506236
2019-03-25/14:50:36.310  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:36.312  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_22881_1550507276
2019-03-25/14:50:36.312  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:36.314  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_24201_1550508248
2019-03-25/14:50:36.314  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:36.316  INFO: parse.ParseDriver - Parsing command: drop table if exists gap_gdx_unique_staging_25288_1550509187
2019-03-25/14:50:36.316  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:36.944  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:36.944  INFO: parse.ParseDriver - Parsing command: select name, myq from table1 lateral view explode(qual, gual) q as myq1, myq2
2019-03-25/14:50:36.945  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:37.823 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-25/14:50:37.829  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:37.831  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= '2019-01-01' and command_type = 'HiveCommand' and qlog like 'temp_temp' and   customer_name like '${customer=%}' group by  to_date(qh.created_at)
2019-03-25/14:50:37.832  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:38.791 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:50:39.211 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:50:39.714 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:50:39.719  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:39.719  INFO: parse.ParseDriver - Parsing command: SELECT matched_events.dt, 'api' AS environment, matched_events.account_id, COALESCE(total_events, 0) AS total_events, total_queries,  matched_queries FROM   (SELECT presto_queries.dt AS dt,  account_id, Count(*) AS total_queries,  Sum(CASE  WHEN presto_events.command_id IS NULL THEN 0  ELSE 1  END) AS matched_queries          FROM   (SELECT dt, id, account_id  FROM   rstore.query_hists WHERE  dt >= '2019-02-21' AND dt <= '2019-02-28' AND command_type = 'PrestoCommand') presto_queries   LEFT JOIN (SELECT command_id AS command_id,  Count(*)  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' AND event_date <= '2019-02-28' GROUP  BY event_date,  command_id,  account_id) presto_events     ON presto_queries.id = presto_events.command_id          GROUP  BY presto_queries.dt, presto_queries.account_id) matched_events    LEFT JOIN (SELECT event_date,  account_id,  Count(*) AS total_events  FROM   processed_v2.presto  WHERE  event_date >= '2019-02-21' and event_date <= '2019-02-28'                   GROUP  BY account_id,  event_date) total_events  ON total_events.event_date = matched_events.dt  AND total_events.account_id = matched_events.account_id
2019-03-25/14:50:39.722  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:41.616  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:41.618  INFO: parse.ParseDriver - Parsing command: alter table mm_viewability_events_test recover partitions
2019-03-25/14:50:41.627  INFO: parse.ParseDriver - Parsing command: select     report_timestamp,    to_date(report_timestamp) as impression_date,    campaign_name,     a.campaign_id,     strat.goal_type as strategy_goal_type, case when length(delphi_metadata)<1 then 'tree brain'   when delphi_metadata like '%_sb%' then 'shared brain'   when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,     case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag, is_viewable as viewable_impressions,  is_measurable as measurable_impressions,     1 as impressions, clicks as clicks,  total_spend_cpm/1000 as spend, -- sum(total_spend_cpm)/count(a.auction_id) as cpm, -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm, -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate, -- coalesce(sum(clicks)/count(a.auction_id),0) as ctr, -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,     video_start as video_start,     video_complete as video_complete,     pv_conversions,     pc_conversions,     pv_revenue,     pc_revenue,     device,     case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type-- coalesce(sum(video_complete)/sum(video_start),0) as vcr from  (select             report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-25/14:50:42.274  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:42.274  INFO: parse.ParseDriver - Parsing command: select      report_timestamp,     to_date(report_timestamp) as impression_date,     campaign_name,      a.campaign_id,      strat.goal_type as strategy_goal_type,  
case when length(delphi_metadata)<1 then 'tree brain'    
when delphi_metadata like '%_sb%' then 'shared brain'    
when delphi_metadata like '%_tf%' then 'log brain' else delphi_metadata end as brain_type,      
case when watermark=0 then 'Non-Watermark' else 'Watermark' end as wm_flag,  
is_viewable as viewable_impressions,   is_measurable as measurable_impressions,      1 as impressions,  clicks as clicks,   total_spend_cpm/1000 as spend,  
-- sum(total_spend_cpm)/count(a.auction_id) as cpm,  -- coalesce(sum(total_spend_cpm)/sum(is_viewable),0) as vcpm,  -- coalesce(sum(in_view_100)/sum(is_measurable),0) as in_view_rate,  
-- coalesce(sum(clicks)/count(a.auction_id),0) as ctr,  -- coalesce(sum(total_spend_cpm/1000)/ sum(clicks),0) as cpc,      video_start as video_start,      
video_complete as video_complete,      pv_conversions,      pc_conversions,      pv_revenue,      pc_revenue,      device,      
case when channel_type in (8,9) then 'in-app' else 'web' end as inventory_type 
-- coalesce(sum(video_complete)/sum(video_start),0) as vcr 
  from  (select   report_timestamp,   delphi_metadata,   auction_id,   campaign_id,    campaign_name,             strategy_id,   watermark,    total_spend_cpm,             device,            channel_typefrom  mm_impressions_ct imp where organization_id = 100977 and impression_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) a join t1_meta_strategy_rs strat on a.strategy_id = strat.idleft join   (  select   imp_auction_id,      event_timestamp_gmt,  case when viewability_event_name = 'is_viewable' then 1 else 0 end as is_viewable,     case when viewability_event_name = 'is_measurable' then 1 else 0 end as is_measurable,     case when viewability_event_name = 'is_viewable_100%' then 1 else 0 end as in_view_100  from   mm_viewability_events_test  where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477) ) bon a.auction_id = b.imp_auction_idleft join (  select   imp_auction_id,   sum(case when event_subtype = 'q4' then 1 else 0 end) as video_complete,  sum(case when event_subtype = 'vst' then 1 else 0 end) as video_start,   sum(case when event_type = 'click' then 1 else 0 end) as clicks,         sum(case when event_type = 'conversion' and pv_pc_flag = 'V' then 1 else 0 end) as pv_conversions,          sum(case when event_type = 'conversion' and pv_pc_flag = 'C' then 1 else 0 end) as pc_conversions,         sum(case when pv_pc_flag = 'V' then mm_v1 else 0 end) as pv_revenue,         sum(case when pv_pc_flag = 'C' then mm_v1 else 0 end) as pc_revenue from   mm_attributed_events_ct where organization_id in (100977) and event_date between date_sub('2019-03-04',1) and date_add('2019-03-05',1)    and to_date(event_report_timestamp) between '2019-03-04' and '2019-03-05' and campaign_id in (614838,617477)        group by imp_auction_id ) c  on a.auction_id = c.imp_auction_id
2019-03-25/14:50:42.744  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:42.745  INFO: parse.ParseDriver - Parsing command: select   at.pv_time_lag, at.pixel_id, e.v10, at.campaign_id, at.event_report_timestamp, at.device_type, at.campaign_name, at.event_timestamp_gmt, e.s9, e.s8, at.pixel_name, e.s2, e.s1, e.s7, e.s6, e.s5, e.s4, at.organization_name, at.strategy_name, at.event_date, e.s10, at.agency_id, at.organization_id, e.v1, at.agency_name, e.v3, e.v4, e.v5, e.v6, e.v7, e.v8, e.v9, at.impression_timestamp_gmt, at.advertiser_id, at.pc_time_lag, at.country, e.v2, e.s3, at.strategy_id, at.browser  from   (     select * from     mm_events    ) e   join    (     select * from     mm_attributed_events_ac   ) at   on       e.pixel_id = at.pixel_id       and e.mm_uuid = at.mm_uuid      and e.timestamp_gmt = at.event_timestamp_gmt  where   at.advertiser_id in (206401) and at.organization_id in (101607) and e.organization_id in (101607) and at.agency_id in (117415) and at.pixel_id in (1299912) and at.event_type = 'conversion' and at.event_date between '2019-03-04' and '2019-03-04' and e.event_date between '2019-03-04' and '2019-03-04'
2019-03-25/14:50:42.747  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:43.677 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_events?account_id=5911
2019-03-25/14:50:44.331 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/mm_attributed_events_ac?account_id=5911
2019-03-25/14:50:44.338  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:44.339  INFO: parse.ParseDriver - Parsing command: select  customer,  cluster,  data,  dt,  ingestedtime  from   (select  customer,  cluster,  data,  dt,  ingestedtime,  row_number() over (partition by get_json_object(cluster,'$.clusterid') order by cast(regexp_replace(regexp_replace(ingestedtime, 'T',' '),'Z','') as timestamp) desc) rnum   from dsa_production.aiq_raw_optimized  where dt='2018-01-23'  and source='get_compute_inventory') a   where rnum=1
2019-03-25/14:50:44.342  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:45.264 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/dsa_production/aiq_raw_optimized?account_id=5911
2019-03-25/14:50:45.269  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:45.269  INFO: parse.ParseDriver - Parsing command: SELECT    logdate as the_date,    hour as the_hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold,    SUM(complete100) AS Complete100,    SUM(streams_viewed) AS Streams_viewed  FROM    
(       SELECT          logdate,          hour,          campaign_key,          placement_key,          ad_key,          IF(Isnull(streams_viewed), 0, streams_viewed) AS Streams_viewed,          IF(Isnull(complete100), 0, complete100) AS Complete100        FROM          core.stats_log        WHERE          logdate = '2019-03-10'           and hour = '11'     )    stats     
join       
(          SELECT             campaign_placement.campaign_placement_key AS campaign_placement_key,             campaign_placement.campaign_placement_id AS campaign_placement_id,             campaign_placement.campaign_placement_name AS campaign_placement_name,             opt_metric,             threshold           FROM             promo2.campaign_placement             
 join                
(                   SELECT                      campaign_placement_id,                      opt_metric,                      threshold                    FROM                      promo2.campaign_placement_optimization_filter                    WHERE                      upper(opt_metric) LIKE '%COMPLETIONS_KPI%'                       AND status = 'Active'                )                selected_placements                
 ON campaign_placement.campaign_placement_id = selected_placements.campaign_placement_id       )       selected_placements_decorated       
 ON selected_placements_decorated.campaign_placement_key = stats.placement_key     
join       promo2.ad a        ON stats.ad_key = a.ad_key     GROUP BY    logdate,    hour,    campaign_key,    campaign_placement_id,    campaign_placement_name,    campaign_placement_key,    stats.ad_key,    a.ad_template,    opt_metric,    threshold
2019-03-25/14:50:45.271  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:46.148 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/core/stats_log?account_id=5911
2019-03-25/14:50:46.514 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement?account_id=5911
2019-03-25/14:50:46.901 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/campaign_placement_optimization_filter?account_id=5911
2019-03-25/14:50:47.272 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/promo2/ad?account_id=5911
2019-03-25/14:50:47.277  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:47.277  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:50:47.277  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:48.317 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:50:48.323  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:48.323  INFO: parse.ParseDriver - Parsing command: SELECT * FROM foo, LATERAL (SELECT * FROM bar WHERE bar.id = foo.bar_id) ss
2019-03-25/14:50:48.923  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:48.923  INFO: parse.ParseDriver - Parsing command: SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s group by a order by cnt
2019-03-25/14:50:48.924  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:49.901 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/14:50:49.905  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:49.914  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:49.914  INFO: parse.ParseDriver - Parsing command: SELECT s.a, b, e, count(s.b) as cnt from (select c as a, d as b from tab1 where c>0 and d<0)s join 
(select a, f from tab2)t on s.a=t.e 
group by s.a, b, e order by cnt
2019-03-25/14:50:49.915  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:50.894 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/14:50:51.450 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab2?account_id=5911
2019-03-25/14:50:51.453  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:51.462  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:51.462  INFO: parse.ParseDriver - Parsing command: WITH a AS (
  SELECT substr(name, 1, 3) x FROM tab1 )
SELECT *
FROM a
WHERE x = 'foo'
2019-03-25/14:50:51.463  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:52.456 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/14:50:52.941 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/a?account_id=5911
2019-03-25/14:50:52.944  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:52.950  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:52.950  INFO: parse.ParseDriver - Parsing command: SELECT IF(CARDINALITY(my_array) >= 3, my_array[3], NULL)
 FROM tab1
2019-03-25/14:50:52.951  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:54.054 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab1?account_id=5911
2019-03-25/14:50:54.057  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:54.063  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:54.063  INFO: parse.ParseDriver - Parsing command: select id, ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
2019-03-25/14:50:54.064  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:54.965 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-25/14:50:54.968  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:54.976  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:54.976  INFO: parse.ParseDriver - Parsing command: SELECT student, score
FROM tests CROSS JOIN UNNEST(scores) AS t (score)
2019-03-25/14:50:54.978  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:54.981  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:54.983  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:55.580  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:55.580  INFO: parse.ParseDriver - Parsing command: SELECT distinct tab.X1 AS a, X2 b from tab where a1>0 and a2!=0 and a3=9
2019-03-25/14:50:55.581  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:56.540 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/14:50:56.543  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:56.549  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:56.549  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:50:56.550  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:57.544 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:50:57.548  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:57.634 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-25/14:50:57.636 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-25/14:50:57.642  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:57.642  INFO: parse.ParseDriver - Parsing command: SELECT *

 FROM DEPT,

 LATERAL TABLE(RAMP(DEPT.DEPTNO)) adid
2019-03-25/14:50:57.648  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:58.141  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:58.142  INFO: parse.ParseDriver - Parsing command: SELECT  ci.id AS cluster_instance_id, ci.cluster_id, unix_timestamp(ci.start_at) AS start_at,  unix_timestamp(ci.down_at) AS down_at, _timestamp AS metric_time, _type AS metric_type,
CASE _type
   WHEN "MEMORY_STATS" THEN arr(total_available_memory, total_used_memory)
   WHEN "VCORES_STATS" THEN arr(total_available_vcores, total_used_vcores)
END AS total 
FROM (SELECT cluster_id, m.total_available_memory, m.total_used_memory, v.total_available_vcores, v.total_used_vcores, e._type, _int(e._timestamp/1000) AS _timestamp FROM processed.yarn 
,LATERAL Table( json_tuple(event_data, 'eventData', 'type', 'timestamp')) AS _eventData, _type, _timestamp 
,LATERAL Table( json_tuple(e._eventData, 'total_memory_mb', 'used_memory_mb'))  total_available_memory, total_used_memory
,LATERAL Table( json_tuple(e._eventData, 'total_vcores', 'used_vcores'))  total_available_vcores, total_used_vcores
WHERE event_date>="$start_date" AND  event_date<"$end_date" AND _type in ("MEMORY_STATS", "VCORES_STATS")) s 
JOIN rstore.cluster_insts ci ON s.cluster_id=ci.cluster_id
WHERE _timestamp BETWEEN unix_timestamp(ci.start_at) AND unix_timestamp(ci.down_at)
2019-03-25/14:50:58.148  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:58.756  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:58.757  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:50:58.757  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:50:59.739 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:50:59.742  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:59.744 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-25/14:50:59.745 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-25/14:50:59.748  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:59.754  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:50:59.754  INFO: parse.ParseDriver - Parsing command: select id,ts,1+sum(col) over(partition by id order by ts) as rnk
from (select id,ts
      ,case when ts-lag(ts,1,ts) over(partition by id order by ts) > 3000 then 1 else 0 end as col
      from tbl
     ) t
2019-03-25/14:50:59.754  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:00.833 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tbl?account_id=5911
2019-03-25/14:51:00.837  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:00.852  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:00.852  INFO: parse.ParseDriver - Parsing command: SELECT   JobTitle,
         MaritalStatus,
         AVG(VacationHours)
FROM     HumanResources.Employee AS E
GROUP BY JobTitle, MaritalStatus
HAVING   x in (select x from tab1)
2019-03-25/14:51:00.854  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:01.722 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/humanresources/employee?account_id=5911
2019-03-25/14:51:01.724  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:01.724  INFO: parse.ParseDriver - Parsing command: select venuestate, venueseats, venuename,
first_value(venuename)
over(partition by venuestate
order by venueseats desc
rows between unbounded preceding and unbounded following)
from (select * from venue where venueseats >0)
group by venuestate order by venuestate
2019-03-25/14:51:02.209  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:02.209  INFO: parse.ParseDriver - Parsing command: CREATE TABLE tabx AS SELECT a, count(s.b) as cnt from (select c as a, d as b from tab where c>0 and d<0)s
2019-03-25/14:51:02.210  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:03.096 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/tab?account_id=5911
2019-03-25/14:51:03.099  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:03.103  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:03.110  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:03.110  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing. stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:51:03.111  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:04.266 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:51:04.269  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/14:51:04.270  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:04.649 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:51:05.043 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:51:05.435 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:51:05.440  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:05.440  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM (SELECT get_json(json, 'location') as location, to_date(created_at) as dt, count(*) num_users FROM db_users WHERE to_date(created_at) >= '2016-08-13'  AND to_date(created_at) <= '2016-08-13'  AND LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location'), to_date(created_at)) by_date JOIN (SELECT get_json(json, 'location') as location, count(*) total_users FROM db_users  WHERE LENGTH(get_json(json, 'location')) > 3  GROUP BY get_json(json, 'location')  HAVING count(*) > 5000) common_locations ON common_locations.location = by_date.location) loc_frac_by_date ON get_json(u.json, 'location') = loc_frac_by_date.location AND to_date(u.created_at) = loc_frac_by_date.dt WHERE loc_frac_by_date.frac_of_location > 7 DISTRIBUTE BY dt
2019-03-25/14:51:05.458  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:06.454 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:51:06.846 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:51:07.262 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:51:07.266  INFO: parse.ParseDriver - Parsing command: SELECT * FROM db_users u JOIN (SELECT * FROM table1) v on u.a=v.b
2019-03-25/14:51:07.266  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:07.655 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/db_users?account_id=5911
2019-03-25/14:51:08.054 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/table1?account_id=5911
2019-03-25/14:51:08.056  INFO: parse.ParseDriver - Parsing command: SELECT a,b, count(*) from ab where s='jrenv' GROUP BY a, b
2019-03-25/14:51:08.056  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:08.894 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/ab?account_id=5911
2019-03-25/14:51:08.898  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:24.152  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:51:24.166  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing. stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:51:25.149  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:26.211 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:51:26.247  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/14:51:26.259  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:51:26.811 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:51:27.198 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:51:27.612 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:53:39.469  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:53:39.484  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing. stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:53:40.435  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:53:41.502 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:53:41.521  INFO: parse.ParseDriver - Parsing command: select to_date(qh.created_at) as dt,  count(qh.id) as num_queries from query_hists qh join user_info ui on qh.qbol_user_id = ui.qu_id join canonical_accounts externals on externals.id = ui.a_id where to_date(qh.created_at) >= date_sub(from_unixtime(unix_timestamp()),30) and command_type = 'HiveCommand' and qlog like '%\"EXECUTION_ENGINE\":\"tez\"%' and   customer_name like "${customer=%}" group by  to_date(qh.created_at) order by dt asc
2019-03-25/14:53:41.530  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:53:41.959 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/query_hists?account_id=5911
2019-03-25/14:53:42.370 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/user_info?account_id=5911
2019-03-25/14:53:42.790 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/default/canonical_accounts?account_id=5911
2019-03-25/14:59:29.373  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:59:29.388  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/14:59:30.429  INFO: parse.ParseDriver - Parse Completed
2019-03-25/14:59:31.428 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/14:59:31.927  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/14:59:32.481 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-25/14:59:32.485 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-25/15:05:25.155  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:05:25.170  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:05:26.321  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:05:27.364 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:05:27.833  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:05:50.570  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:05:50.589  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:05:51.649  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:05:52.851 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:05:53.284  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:08:31.315  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:08:31.328  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:08:32.309  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:08:33.263 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:08:33.644  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:25:11.000  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:25:11.016  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:25:11.985  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:25:12.996 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:25:13.420  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:32:14.262  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:32:14.277  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:32:15.263  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:32:16.509 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:32:16.909  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:33:25.894  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:33:25.914  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:33:27.070  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:33:28.304 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:33:28.833  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:33:40.677  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:33:40.693  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:33:41.646  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:33:42.681 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:33:43.068  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:34:47.832  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:34:47.847  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:34:48.817  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:34:52.569 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:34:52.940  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:37:42.248  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:37:42.270  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:37:43.379  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:37:44.947 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:37:45.496  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:38:04.959  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:38:05.303  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:39:34.537  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:39:34.881  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:41:37.882  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:41:37.899  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/15:41:38.858  INFO: parse.ParseDriver - Parse Completed
2019-03-25/15:41:39.863 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/15:41:40.284  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:41:46.845  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:41:47.182  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:43:59.884  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:44:00.222  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:45:30.162  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:45:30.519  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:51:09.278  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:51:09.779  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:57:36.732  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/15:57:37.091  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:00:17.993  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:00:18.334  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:04:53.866  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:04:54.223  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:06:18.256  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:06:18.598  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:07:50.031  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:07:50.402  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:11:42.987  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:11:43.330  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:28:49.279  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:28:49.293  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/16:28:50.282  INFO: parse.ParseDriver - Parse Completed
2019-03-25/16:28:51.339 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/16:28:51.722  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:31:56.523  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:31:56.537  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/16:31:57.566  INFO: parse.ParseDriver - Parse Completed
2019-03-25/16:31:58.642 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/16:31:59.095  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:33:38.274  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:33:38.290  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/16:33:39.269  INFO: parse.ParseDriver - Parse Completed
2019-03-25/16:33:40.279 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/16:33:40.696  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:38:11.686  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:38:11.700  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/16:38:12.687  INFO: parse.ParseDriver - Parse Completed
2019-03-25/16:38:13.854 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/16:38:14.237  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:40:52.496  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:40:52.837  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:47:49.800  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/16:47:49.815  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/16:47:50.808  INFO: parse.ParseDriver - Parse Completed
2019-03-25/16:47:51.851 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/16:47:52.264  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/22:59:19.551  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/22:59:19.565  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/22:59:20.640  INFO: parse.ParseDriver - Parse Completed
2019-03-25/22:59:21.825 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/22:59:22.292  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:05:10.471  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:05:10.486  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:05:11.474  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:05:12.741 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:05:13.158  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:11:06.041  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:11:06.056  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:11:07.044  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:11:08.393 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:11:08.802  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:12:38.710  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:12:38.723  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:12:39.713  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:12:40.910 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:12:41.332  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:42:22.385  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:42:22.407  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:42:23.483  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:42:24.986 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:42:25.454  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:50:34.758  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:50:34.778  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:50:35.805  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:50:37.117 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:50:37.521  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:53:04.657  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:55:08.473  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:55:08.489  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:55:09.491  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:55:10.894 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:55:11.270  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:57:30.544  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:57:30.560  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:57:31.618  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:57:33.136 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:57:33.533  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:58:25.704  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-25/23:58:25.722  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-25/23:58:26.837  INFO: parse.ParseDriver - Parse Completed
2019-03-25/23:58:28.491 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-25/23:58:28.872  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:02:45.254  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:02:45.280  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-26/00:02:46.315  INFO: parse.ParseDriver - Parse Completed
2019-03-26/00:02:47.584 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-26/00:02:48.038  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:03:31.260  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:03:31.274  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-26/00:03:32.340  INFO: parse.ParseDriver - Parse Completed
2019-03-26/00:03:33.584 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-26/00:03:33.996  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:04:50.135  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:04:50.150  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-26/00:04:51.134  INFO: parse.ParseDriver - Parse Completed
2019-03-26/00:04:52.613 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-26/00:04:53.127  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:06:11.360  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:06:11.382  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-26/00:06:12.408  INFO: parse.ParseDriver - Parse Completed
2019-03-26/00:06:13.863 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-26/00:06:14.351  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:06:14.976 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-26/00:06:14.979 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
2019-03-26/00:07:19.019  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:07:19.036  INFO: parse.ParseDriver - Parsing command: SELECT logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct FROM marketing.stats_log_survey WHERE survey_id='ZmOwqVvLFKtWroPKX5VN' AND event IN ('svyresp','svystart','svycomp') AND logdate>'2015-09-01' GROUP BY logdate, site_key, survey_id, placement_key, question_id, answer_id, tm_client_id, auction_id, exposed, correct
2019-03-26/00:07:20.565  INFO: parse.ParseDriver - Parse Completed
2019-03-26/00:07:21.913 ERROR: metastore.APIMetastoreClient - Error fetching metadata from API: java.io.FileNotFoundException: https://api.qubole.com/api/internal/hive/marketing/stats_log_survey?account_id=5911
2019-03-26/00:07:22.779  INFO: parse.SqlCommandHandler - Lexing successful for the query 
2019-03-26/00:07:23.582 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteException: Non-query expression encountered in illegal context
2019-03-26/00:07:23.585 ERROR: runtime.CalciteException - org.apache.calcite.runtime.CalciteContextException: From line 1, column 1 to line 1, column 3: Non-query expression encountered in illegal context
